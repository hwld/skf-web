import type { Problem } from "~/models/problem";

export const allProblems: Problem[] = [
  {
    id: "1",
    title: "[列の操作]  全項目指定",
    description:
      "レシート明細データ（receipt）から全項目の先頭10件を表示し、どのようなデータを保有しているか目視で確認せよ。",
    solutions: [
      {
        sql: "SELECT\n    *\nFROM receipt\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "sales_ymd",
            "sales_epoch",
            "store_cd",
            "receipt_no",
            "receipt_sub_no",
            "customer_id",
            "product_cd",
            "quantity",
            "amount",
          ],
          rows: [
            [
              "20181103",
              "1541203200",
              "S14006",
              "112",
              "1",
              "CS006214000001",
              "P070305012",
              "1",
              "158",
            ],
            [
              "20181118",
              "1542499200",
              "S13008",
              "1132",
              "2",
              "CS008415000097",
              "P070701017",
              "1",
              "81",
            ],
            [
              "20170712",
              "1499817600",
              "S14028",
              "1102",
              "1",
              "CS028414000014",
              "P060101005",
              "1",
              "170",
            ],
            [
              "20190205",
              "1549324800",
              "S14042",
              "1132",
              "1",
              "ZZ000000000000",
              "P050301001",
              "1",
              "25",
            ],
            [
              "20180821",
              "1534809600",
              "S14025",
              "1102",
              "2",
              "CS025415000050",
              "P060102007",
              "1",
              "90",
            ],
            [
              "20190605",
              "1559692800",
              "S13003",
              "1112",
              "1",
              "CS003515000195",
              "P050102002",
              "1",
              "138",
            ],
            [
              "20181205",
              "1543968000",
              "S14024",
              "1102",
              "2",
              "CS024514000042",
              "P080101005",
              "1",
              "30",
            ],
            [
              "20190922",
              "1569110400",
              "S14040",
              "1102",
              "1",
              "CS040415000178",
              "P070501004",
              "1",
              "128",
            ],
            [
              "20170504",
              "1493856000",
              "S13020",
              "1112",
              "2",
              "ZZ000000000000",
              "P071302010",
              "1",
              "770",
            ],
            [
              "20191010",
              "1570665600",
              "S14027",
              "1102",
              "1",
              "CS027514000015",
              "P071101003",
              "1",
              "680",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#D4D4D4">    *</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "2",
    title: "[列の操作]  列指定",
    description:
      "レシート明細データ（receipt）から売上年月日（sales_ymd）、顧客ID（customer_id）、商品コード（product_cd）、売上金額（amount）の順に列を指定し、10件表示せよ。",
    solutions: [
      {
        sql: "SELECT\n    sales_ymd,\n    customer_id,\n    product_cd,\n    amount\nFROM receipt\nLIMIT 10\n;",
        expectedResult: {
          fields: ["sales_ymd", "customer_id", "product_cd", "amount"],
          rows: [
            ["20181103", "CS006214000001", "P070305012", "158"],
            ["20181118", "CS008415000097", "P070701017", "81"],
            ["20170712", "CS028414000014", "P060101005", "170"],
            ["20190205", "ZZ000000000000", "P050301001", "25"],
            ["20180821", "CS025415000050", "P060102007", "90"],
            ["20190605", "CS003515000195", "P050102002", "138"],
            ["20181205", "CS024514000042", "P080101005", "30"],
            ["20190922", "CS040415000178", "P070501004", "128"],
            ["20170504", "ZZ000000000000", "P071302010", "770"],
            ["20191010", "CS027514000015", "P071101003", "680"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    product_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "3",
    title: "[列の操作]  列名変更",
    description:
      "レシート明細データ（receipt）から売上年月日（sales_ymd）、顧客ID（customer_id）、商品コード（product_cd）、売上金額（amount）の順に列を指定し、10件表示せよ。ただし、sales_ymdをsales_dateに項目名を変更しながら抽出すること。",
    solutions: [
      {
        sql: "SELECT\n    sales_ymd AS sales_date,\n    customer_id,\n    product_cd,\n    amount \nFROM receipt\nLIMIT 10\n;",
        expectedResult: {
          fields: ["sales_date", "customer_id", "product_cd", "amount"],
          rows: [
            ["20181103", "CS006214000001", "P070305012", "158"],
            ["20181118", "CS008415000097", "P070701017", "81"],
            ["20170712", "CS028414000014", "P060101005", "170"],
            ["20190205", "ZZ000000000000", "P050301001", "25"],
            ["20180821", "CS025415000050", "P060102007", "90"],
            ["20190605", "CS003515000195", "P050102002", "138"],
            ["20181205", "CS024514000042", "P080101005", "30"],
            ["20190922", "CS040415000178", "P070501004", "128"],
            ["20170504", "ZZ000000000000", "P071302010", "770"],
            ["20191010", "CS027514000015", "P071101003", "680"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sales_date,</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    product_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount </span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "4",
    title: "[行の操作]  単一条件",
    description:
      'レシート明細データ（receipt）から売上日（sales_ymd）、顧客ID（customer_id）、商品コード（product_cd）、売上金額（amount）の順に列を指定し、以下の条件を満たすデータを抽出せよ。\n\n顧客ID（customer_id）が"CS018205000001"',
    solutions: [
      {
        sql: "SELECT\n    sales_ymd,\n    customer_id,\n    product_cd,\n    amount\nFROM\n    receipt\nWHERE\n    customer_id = 'CS018205000001'\n;",
        expectedResult: {
          fields: ["sales_ymd", "customer_id", "product_cd", "amount"],
          rows: [
            ["20180911", "CS018205000001", "P071401012", "2200"],
            ["20180414", "CS018205000001", "P060104007", "600"],
            ["20170614", "CS018205000001", "P050206001", "990"],
            ["20170614", "CS018205000001", "P060702015", "108"],
            ["20190216", "CS018205000001", "P071005024", "102"],
            ["20180414", "CS018205000001", "P071101002", "278"],
            ["20190226", "CS018205000001", "P070902035", "168"],
            ["20190924", "CS018205000001", "P060805001", "495"],
            ["20190226", "CS018205000001", "P071401020", "2200"],
            ["20180911", "CS018205000001", "P071401005", "1100"],
            ["20190216", "CS018205000001", "P040101002", "218"],
            ["20190924", "CS018205000001", "P091503001", "280"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    product_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt</span></span>\n<span class="line"><span style="color:#569CD6">WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'CS018205000001\'</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "5",
    title: "[行の操作]  複数条件1",
    description:
      'レシート明細データ（receipt）から売上日（sales_ymd）、顧客ID（customer_id）、商品コード（product_cd）、売上金額（amount）の順に列を指定し、以下の全ての条件を満たすデータを抽出せよ。\n\n顧客ID（customer_id）が"CS018205000001"\n売上金額（amount）が1,000以上',
    solutions: [
      {
        sql: "SELECT\n    sales_ymd,\n    customer_id,\n    product_cd,\n    amount\nFROM\n    receipt\nWHERE\n    customer_id = 'CS018205000001'\n    AND amount >= 1000\n;",
        expectedResult: {
          fields: ["sales_ymd", "customer_id", "product_cd", "amount"],
          rows: [
            ["20180911", "CS018205000001", "P071401012", "2200"],
            ["20190226", "CS018205000001", "P071401020", "2200"],
            ["20180911", "CS018205000001", "P071401005", "1100"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    product_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt</span></span>\n<span class="line"><span style="color:#569CD6">WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'CS018205000001\'</span></span>\n<span class="line"><span style="color:#569CD6">    AND</span><span style="color:#E6E6E6"> amount </span><span style="color:#D4D4D4">>=</span><span style="color:#B5CEA8"> 1000</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "6",
    title: "[行の操作]  複数条件2",
    description:
      'レシート明細データ（receipt）から売上日（sales_ymd）、顧客ID（customer_id）、商品コード（product_cd）、売上数量（quantity）、売上金額（amount）の順に列を指定し、以下の全ての条件を満たすデータを抽出せよ。\n\n顧客ID（customer_id）が"CS018205000001"\n売上金額（amount）が1,000以上または売上数量（quantity）が5以上',
    solutions: [
      {
        sql: "SELECT\n    sales_ymd,\n    customer_id,\n    product_cd,\n    quantity,\n    amount\nFROM\n    receipt\nWHERE\n    customer_id = 'CS018205000001'\n    AND\n    (\n        amount >= 1000\n        OR quantity >= 5\n    )\n;",
        expectedResult: {
          fields: [
            "sales_ymd",
            "customer_id",
            "product_cd",
            "quantity",
            "amount",
          ],
          rows: [
            ["20180911", "CS018205000001", "P071401012", "1", "2200"],
            ["20180414", "CS018205000001", "P060104007", "6", "600"],
            ["20170614", "CS018205000001", "P050206001", "5", "990"],
            ["20190226", "CS018205000001", "P071401020", "1", "2200"],
            ["20180911", "CS018205000001", "P071401005", "1", "1100"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    product_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    quantity,</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt</span></span>\n<span class="line"><span style="color:#569CD6">WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'CS018205000001\'</span></span>\n<span class="line"><span style="color:#569CD6">    AND</span></span>\n<span class="line"><span style="color:#E6E6E6">    (</span></span>\n<span class="line"><span style="color:#E6E6E6">        amount </span><span style="color:#D4D4D4">>=</span><span style="color:#B5CEA8"> 1000</span></span>\n<span class="line"><span style="color:#569CD6">        OR</span><span style="color:#E6E6E6"> quantity </span><span style="color:#D4D4D4">>=</span><span style="color:#B5CEA8"> 5</span></span>\n<span class="line"><span style="color:#E6E6E6">    )</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "7",
    title: "[行の操作]  範囲指定",
    description:
      'レシート明細データ（receipt）から売上日（sales_ymd）、顧客ID（customer_id）、商品コード（product_cd）、売上金額（amount）の順に列を指定し、以下の全ての条件を満たすデータを抽出せよ。\n\n顧客ID（customer_id）が"CS018205000001"\n売上金額（amount）が1,000以上2,000以下',
    solutions: [
      {
        sql: "SELECT\n    sales_ymd,\n    customer_id,\n    product_cd,\n    amount\nFROM\n    receipt\nWHERE\n    customer_id = 'CS018205000001'\n    AND amount BETWEEN 1000 AND 2000\n;",
        expectedResult: {
          fields: ["sales_ymd", "customer_id", "product_cd", "amount"],
          rows: [["20180911", "CS018205000001", "P071401005", "1100"]],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    product_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt</span></span>\n<span class="line"><span style="color:#569CD6">WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'CS018205000001\'</span></span>\n<span class="line"><span style="color:#569CD6">    AND</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">BETWEEN</span><span style="color:#B5CEA8"> 1000</span><span style="color:#569CD6"> AND</span><span style="color:#B5CEA8"> 2000</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "8",
    title: "[行の操作]  不一致",
    description:
      'レシート明細データ（receipt）から売上日（sales_ymd）、顧客ID（customer_id）、商品コード（product_cd）、売上金額（amount）の順に列を指定し、以下の全ての条件を満たすデータを抽出せよ。\n\n顧客ID（customer_id）が"CS018205000001"\n商品コード（product_cd）が"P071401019"以外',
    solutions: [
      {
        sql: "SELECT\n    sales_ymd,\n    customer_id,\n    product_cd, amount\nFROM\n    receipt\nWHERE\n    customer_id = 'CS018205000001'\n    AND product_cd != 'P071401019'\n;",
        expectedResult: {
          fields: ["sales_ymd", "customer_id", "product_cd", "amount"],
          rows: [
            ["20180911", "CS018205000001", "P071401012", "2200"],
            ["20180414", "CS018205000001", "P060104007", "600"],
            ["20170614", "CS018205000001", "P050206001", "990"],
            ["20170614", "CS018205000001", "P060702015", "108"],
            ["20190216", "CS018205000001", "P071005024", "102"],
            ["20180414", "CS018205000001", "P071101002", "278"],
            ["20190226", "CS018205000001", "P070902035", "168"],
            ["20190924", "CS018205000001", "P060805001", "495"],
            ["20190226", "CS018205000001", "P071401020", "2200"],
            ["20180911", "CS018205000001", "P071401005", "1100"],
            ["20190216", "CS018205000001", "P040101002", "218"],
            ["20190924", "CS018205000001", "P091503001", "280"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    product_cd, amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt</span></span>\n<span class="line"><span style="color:#569CD6">WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'CS018205000001\'</span></span>\n<span class="line"><span style="color:#569CD6">    AND</span><span style="color:#E6E6E6"> product_cd </span><span style="color:#D4D4D4">!=</span><span style="color:#CE9178"> \'P071401019\'</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "9",
    title: "[行の操作]  補集合",
    description:
      "以下の処理において、出力結果を変えずにORをANDに書き換えよ。\nSELECT * FROM store WHERE NOT (prefecture_cd = '13' OR floor_area > 900)",
    solutions: [
      {
        sql: "SELECT * FROM store WHERE prefecture_cd != '13' AND floor_area <= 900;",
        expectedResult: {
          fields: [
            "store_cd",
            "store_name",
            "prefecture_cd",
            "prefecture",
            "address",
            "address_kana",
            "tel_no",
            "longitude",
            "latitude",
            "floor_area",
          ],
          rows: [
            [
              "S14046",
              "北山田店",
              "14",
              "神奈川県",
              "神奈川県横浜市都筑区北山田一丁目",
              "カナガワケンヨコハマシツヅキクキタヤマタイッチョウメ",
              "045-123-4049",
              "139.5916",
              "35.56189",
              "831.0",
            ],
            [
              "S14011",
              "日吉本町店",
              "14",
              "神奈川県",
              "神奈川県横浜市港北区日吉本町四丁目",
              "カナガワケンヨコハマシコウホククヒヨシホンチョウヨンチョウメ",
              "045-123-4033",
              "139.6316",
              "35.54655",
              "890.0",
            ],
            [
              "S12013",
              "習志野店",
              "12",
              "千葉県",
              "千葉県習志野市芝園一丁目",
              "チバケンナラシノシシバゾノイッチョウメ",
              "047-123-4002",
              "140.022",
              "35.66122",
              "808.0",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#D4D4D4"> *</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> store </span><span style="color:#569CD6">WHERE</span><span style="color:#E6E6E6"> prefecture_cd </span><span style="color:#D4D4D4">!=</span><span style="color:#CE9178"> \'13\'</span><span style="color:#569CD6"> AND</span><span style="color:#E6E6E6"> floor_area </span><span style="color:#D4D4D4">&#x3C;=</span><span style="color:#B5CEA8"> 900</span><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "10",
    title: "[あいまい検索]  前方一致",
    description:
      '店舗データ（store）から、店舗コード（store_cd）が"S14"で始まるものだけ全項目抽出し、10件表示せよ。',
    solutions: [
      {
        sql: "SELECT\n    *\nFROM store\nWHERE\n    store_cd LIKE 'S14%'\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "store_cd",
            "store_name",
            "prefecture_cd",
            "prefecture",
            "address",
            "address_kana",
            "tel_no",
            "longitude",
            "latitude",
            "floor_area",
          ],
          rows: [
            [
              "S14010",
              "菊名店",
              "14",
              "神奈川県",
              "神奈川県横浜市港北区菊名一丁目",
              "カナガワケンヨコハマシコウホククキクナイッチョウメ",
              "045-123-4032",
              "139.6326",
              "35.50049",
              "1732.0",
            ],
            [
              "S14033",
              "阿久和店",
              "14",
              "神奈川県",
              "神奈川県横浜市瀬谷区阿久和西一丁目",
              "カナガワケンヨコハマシセヤクアクワニシイッチョウメ",
              "045-123-4043",
              "139.4961",
              "35.45918",
              "1495.0",
            ],
            [
              "S14036",
              "相模原中央店",
              "14",
              "神奈川県",
              "神奈川県相模原市中央二丁目",
              "カナガワケンサガミハラシチュウオウニチョウメ",
              "042-123-4045",
              "139.3716",
              "35.57327",
              "1679.0",
            ],
            [
              "S14040",
              "長津田店",
              "14",
              "神奈川県",
              "神奈川県横浜市緑区長津田みなみ台五丁目",
              "カナガワケンヨコハマシミドリクナガツタミナミダイゴチョウメ",
              "045-123-4046",
              "139.4994",
              "35.52398",
              "1548.0",
            ],
            [
              "S14050",
              "阿久和西店",
              "14",
              "神奈川県",
              "神奈川県横浜市瀬谷区阿久和西一丁目",
              "カナガワケンヨコハマシセヤクアクワニシイッチョウメ",
              "045-123-4053",
              "139.4961",
              "35.45918",
              "1830.0",
            ],
            [
              "S14028",
              "二ツ橋店",
              "14",
              "神奈川県",
              "神奈川県横浜市瀬谷区二ツ橋町",
              "カナガワケンヨコハマシセヤクフタツバシチョウ",
              "045-123-4042",
              "139.4963",
              "35.46304",
              "1574.0",
            ],
            [
              "S14012",
              "本牧和田店",
              "14",
              "神奈川県",
              "神奈川県横浜市中区本牧和田",
              "カナガワケンヨコハマシナカクホンモクワダ",
              "045-123-4034",
              "139.6582",
              "35.42156",
              "1341.0",
            ],
            [
              "S14046",
              "北山田店",
              "14",
              "神奈川県",
              "神奈川県横浜市都筑区北山田一丁目",
              "カナガワケンヨコハマシツヅキクキタヤマタイッチョウメ",
              "045-123-4049",
              "139.5916",
              "35.56189",
              "831.0",
            ],
            [
              "S14022",
              "逗子店",
              "14",
              "神奈川県",
              "神奈川県逗子市逗子一丁目",
              "カナガワケンズシシズシイッチョウメ",
              "046-123-4036",
              "139.5789",
              "35.29642",
              "1838.0",
            ],
            [
              "S14011",
              "日吉本町店",
              "14",
              "神奈川県",
              "神奈川県横浜市港北区日吉本町四丁目",
              "カナガワケンヨコハマシコウホククヒヨシホンチョウヨンチョウメ",
              "045-123-4033",
              "139.6316",
              "35.54655",
              "890.0",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#D4D4D4">    *</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> store</span></span>\n<span class="line"><span style="color:#569CD6">WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">    store_cd </span><span style="color:#569CD6">LIKE</span><span style="color:#CE9178"> \'S14%\'</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "11",
    title: "[あいまい検索]  後方一致",
    description:
      "顧客データ（customer）から顧客ID（customer_id）の末尾が1のものだけ全項目抽出し、10件表示せよ。",
    solutions: [
      {
        sql: "SELECT * FROM customer WHERE customer_id LIKE '%1' LIMIT 10;",
        expectedResult: {
          fields: [
            "customer_id",
            "customer_name",
            "gender_cd",
            "gender",
            "birth_day",
            "age",
            "postal_cd",
            "address",
            "application_store_cd",
            "application_date",
            "status_cd",
          ],
          rows: [
            [
              "CS037613000071",
              "六角 雅彦",
              "9",
              "不明",
              "1952-04-01",
              "66",
              "136-0076",
              "東京都江東区南砂**********",
              "S13037",
              "20150414",
              "0-00000000-0",
            ],
            [
              "CS028811000001",
              "堀井 かおり",
              "1",
              "女性",
              "1933-03-27",
              "86",
              "245-0016",
              "神奈川県横浜市泉区和泉町**********",
              "S14028",
              "20160115",
              "0-00000000-0",
            ],
            [
              "CS040412000191",
              "川井 郁恵",
              "1",
              "女性",
              "1977-01-05",
              "42",
              "226-0021",
              "神奈川県横浜市緑区北八朔町**********",
              "S14040",
              "20151101",
              "1-20091025-4",
            ],
            [
              "CS028314000011",
              "小菅 あおい",
              "1",
              "女性",
              "1983-11-26",
              "35",
              "246-0038",
              "神奈川県横浜市瀬谷区宮沢**********",
              "S14028",
              "20151123",
              "1-20080426-5",
            ],
            [
              "CS039212000051",
              "藤島 恵梨香",
              "1",
              "女性",
              "1997-02-03",
              "22",
              "166-0001",
              "東京都杉並区阿佐谷北**********",
              "S13039",
              "20171121",
              "1-20100215-4",
            ],
            [
              "CS015412000111",
              "松居 奈月",
              "1",
              "女性",
              "1972-10-04",
              "46",
              "136-0071",
              "東京都江東区亀戸**********",
              "S13015",
              "20150629",
              "0-00000000-0",
            ],
            [
              "CS004702000041",
              "野島 洋",
              "0",
              "男性",
              "1943-08-24",
              "75",
              "176-0022",
              "東京都練馬区向山**********",
              "S13004",
              "20170218",
              "0-00000000-0",
            ],
            [
              "CS041515000001",
              "栗田 千夏",
              "1",
              "女性",
              "1967-01-02",
              "52",
              "206-0001",
              "東京都多摩市和田**********",
              "S13041",
              "20160422",
              "E-20100803-F",
            ],
            [
              "CS029313000221",
              "北条 ひかり",
              "1",
              "女性",
              "1987-06-19",
              "31",
              "279-0011",
              "千葉県浦安市美浜**********",
              "S12029",
              "20180810",
              "0-00000000-0",
            ],
            [
              "CS034312000071",
              "望月 奈央",
              "1",
              "女性",
              "1980-09-20",
              "38",
              "213-0026",
              "神奈川県川崎市高津区久末**********",
              "S14034",
              "20160106",
              "0-00000000-0",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#D4D4D4"> *</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> customer </span><span style="color:#569CD6">WHERE</span><span style="color:#E6E6E6"> customer_id </span><span style="color:#569CD6">LIKE</span><span style="color:#CE9178"> \'%1\'</span><span style="color:#569CD6"> LIMIT</span><span style="color:#B5CEA8"> 10</span><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "12",
    title: "[あいまい検索]  部分一致1",
    description:
      '店舗データ（store）から、住所 (address) に"横浜市"が含まれるものだけ全項目表示せよ。',
    solutions: [
      {
        sql: "SELECT * FROM store WHERE address LIKE '%横浜市%';",
        expectedResult: {
          fields: [
            "store_cd",
            "store_name",
            "prefecture_cd",
            "prefecture",
            "address",
            "address_kana",
            "tel_no",
            "longitude",
            "latitude",
            "floor_area",
          ],
          rows: [
            [
              "S14010",
              "菊名店",
              "14",
              "神奈川県",
              "神奈川県横浜市港北区菊名一丁目",
              "カナガワケンヨコハマシコウホククキクナイッチョウメ",
              "045-123-4032",
              "139.6326",
              "35.50049",
              "1732.0",
            ],
            [
              "S14033",
              "阿久和店",
              "14",
              "神奈川県",
              "神奈川県横浜市瀬谷区阿久和西一丁目",
              "カナガワケンヨコハマシセヤクアクワニシイッチョウメ",
              "045-123-4043",
              "139.4961",
              "35.45918",
              "1495.0",
            ],
            [
              "S14040",
              "長津田店",
              "14",
              "神奈川県",
              "神奈川県横浜市緑区長津田みなみ台五丁目",
              "カナガワケンヨコハマシミドリクナガツタミナミダイゴチョウメ",
              "045-123-4046",
              "139.4994",
              "35.52398",
              "1548.0",
            ],
            [
              "S14050",
              "阿久和西店",
              "14",
              "神奈川県",
              "神奈川県横浜市瀬谷区阿久和西一丁目",
              "カナガワケンヨコハマシセヤクアクワニシイッチョウメ",
              "045-123-4053",
              "139.4961",
              "35.45918",
              "1830.0",
            ],
            [
              "S14028",
              "二ツ橋店",
              "14",
              "神奈川県",
              "神奈川県横浜市瀬谷区二ツ橋町",
              "カナガワケンヨコハマシセヤクフタツバシチョウ",
              "045-123-4042",
              "139.4963",
              "35.46304",
              "1574.0",
            ],
            [
              "S14012",
              "本牧和田店",
              "14",
              "神奈川県",
              "神奈川県横浜市中区本牧和田",
              "カナガワケンヨコハマシナカクホンモクワダ",
              "045-123-4034",
              "139.6582",
              "35.42156",
              "1341.0",
            ],
            [
              "S14046",
              "北山田店",
              "14",
              "神奈川県",
              "神奈川県横浜市都筑区北山田一丁目",
              "カナガワケンヨコハマシツヅキクキタヤマタイッチョウメ",
              "045-123-4049",
              "139.5916",
              "35.56189",
              "831.0",
            ],
            [
              "S14011",
              "日吉本町店",
              "14",
              "神奈川県",
              "神奈川県横浜市港北区日吉本町四丁目",
              "カナガワケンヨコハマシコウホククヒヨシホンチョウヨンチョウメ",
              "045-123-4033",
              "139.6316",
              "35.54655",
              "890.0",
            ],
            [
              "S14048",
              "中川中央店",
              "14",
              "神奈川県",
              "神奈川県横浜市都筑区中川中央二丁目",
              "カナガワケンヨコハマシツヅキクナカガワチュウオウニチョウメ",
              "045-123-4051",
              "139.5758",
              "35.54912",
              "1657.0",
            ],
            [
              "S14042",
              "新山下店",
              "14",
              "神奈川県",
              "神奈川県横浜市中区新山下二丁目",
              "カナガワケンヨコハマシナカクシンヤマシタニチョウメ",
              "045-123-4047",
              "139.6593",
              "35.43894",
              "1044.0",
            ],
            [
              "S14006",
              "葛が谷店",
              "14",
              "神奈川県",
              "神奈川県横浜市都筑区葛が谷",
              "カナガワケンヨコハマシツヅキククズガヤ",
              "045-123-4031",
              "139.5633",
              "35.53573",
              "1886.0",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#D4D4D4"> *</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> store </span><span style="color:#569CD6">WHERE</span><span style="color:#569CD6"> address</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'%横浜市%\'</span><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "13",
    title: "[あいまい検索]  部分一致2",
    description:
      "顧客データ（customer）から、ステータスコード（status_cd）の先頭がアルファベットのA〜Fで始まるデータを全項目抽出し、10件表示せよ。",
    solutions: [
      {
        sql: "SELECT * FROM customer WHERE status_cd ~ '^[A-F]' LIMIT 10;",
        expectedResult: {
          fields: [
            "customer_id",
            "customer_name",
            "gender_cd",
            "gender",
            "birth_day",
            "age",
            "postal_cd",
            "address",
            "application_store_cd",
            "application_date",
            "status_cd",
          ],
          rows: [
            [
              "CS031415000172",
              "宇多田 貴美子",
              "1",
              "女性",
              "1976-10-04",
              "42",
              "151-0053",
              "東京都渋谷区代々木**********",
              "S13031",
              "20150529",
              "D-20100325-C",
            ],
            [
              "CS015414000103",
              "奥野 陽子",
              "1",
              "女性",
              "1977-08-09",
              "41",
              "136-0073",
              "東京都江東区北砂**********",
              "S13015",
              "20150722",
              "B-20100609-B",
            ],
            [
              "CS011215000048",
              "芦田 沙耶",
              "1",
              "女性",
              "1992-02-01",
              "27",
              "223-0062",
              "神奈川県横浜市港北区日吉本町**********",
              "S14011",
              "20150228",
              "C-20100421-9",
            ],
            [
              "CS029415000023",
              "梅田 里穂",
              "1",
              "女性",
              "1976-01-17",
              "43",
              "279-0043",
              "千葉県浦安市富士見**********",
              "S12029",
              "20150610",
              "D-20100918-E",
            ],
            [
              "CS035415000029",
              "寺沢 真希",
              "9",
              "不明",
              "1977-09-27",
              "41",
              "158-0096",
              "東京都世田谷区玉川台**********",
              "S13035",
              "20141220",
              "F-20101029-F",
            ],
            [
              "CS031415000106",
              "宇野 由美子",
              "1",
              "女性",
              "1970-02-26",
              "49",
              "151-0053",
              "東京都渋谷区代々木**********",
              "S13031",
              "20150201",
              "F-20100511-E",
            ],
            [
              "CS029215000025",
              "石倉 美帆",
              "1",
              "女性",
              "1993-09-28",
              "25",
              "279-0022",
              "千葉県浦安市今川**********",
              "S12029",
              "20150708",
              "B-20100820-C",
            ],
            [
              "CS033605000005",
              "猪股 雄太",
              "0",
              "男性",
              "1955-12-05",
              "63",
              "246-0031",
              "神奈川県横浜市瀬谷区瀬谷**********",
              "S14033",
              "20150425",
              "F-20100917-E",
            ],
            [
              "CS033415000229",
              "板垣 菜々美",
              "1",
              "女性",
              "1977-11-07",
              "41",
              "246-0021",
              "神奈川県横浜市瀬谷区二ツ橋町**********",
              "S14033",
              "20150712",
              "F-20100326-E",
            ],
            [
              "CS008415000145",
              "黒谷 麻緒",
              "1",
              "女性",
              "1977-06-27",
              "41",
              "157-0067",
              "東京都世田谷区喜多見**********",
              "S13008",
              "20150829",
              "F-20100622-F",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#D4D4D4"> *</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> customer </span><span style="color:#569CD6">WHERE</span><span style="color:#E6E6E6"> status_cd ~ </span><span style="color:#CE9178">\'^[A-F]\'</span><span style="color:#569CD6"> LIMIT</span><span style="color:#B5CEA8"> 10</span><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "14",
    title: "[あいまい検索]  部分一致3",
    description:
      "顧客データ（customer）から、ステータスコード（status_cd）の末尾が数字の1〜9で終わるデータを全項目抽出し、10件表示せよ。",
    solutions: [
      {
        sql: "SELECT * FROM customer WHERE status_cd ~ '[1-9]$' LIMIT 10;",
        expectedResult: {
          fields: [
            "customer_id",
            "customer_name",
            "gender_cd",
            "gender",
            "birth_day",
            "age",
            "postal_cd",
            "address",
            "application_store_cd",
            "application_date",
            "status_cd",
          ],
          rows: [
            [
              "CS001215000145",
              "田崎 美紀",
              "1",
              "女性",
              "1995-03-29",
              "24",
              "144-0055",
              "東京都大田区仲六郷**********",
              "S13001",
              "20170605",
              "6-20090929-2",
            ],
            [
              "CS033513000180",
              "安斎 遥",
              "1",
              "女性",
              "1962-07-11",
              "56",
              "241-0823",
              "神奈川県横浜市旭区善部町**********",
              "S14033",
              "20150728",
              "6-20080506-5",
            ],
            [
              "CS011215000048",
              "芦田 沙耶",
              "1",
              "女性",
              "1992-02-01",
              "27",
              "223-0062",
              "神奈川県横浜市港北区日吉本町**********",
              "S14011",
              "20150228",
              "C-20100421-9",
            ],
            [
              "CS040412000191",
              "川井 郁恵",
              "1",
              "女性",
              "1977-01-05",
              "42",
              "226-0021",
              "神奈川県横浜市緑区北八朔町**********",
              "S14040",
              "20151101",
              "1-20091025-4",
            ],
            [
              "CS009315000023",
              "皆川 文世",
              "1",
              "女性",
              "1980-04-15",
              "38",
              "154-0012",
              "東京都世田谷区駒沢**********",
              "S13009",
              "20150319",
              "5-20080322-1",
            ],
            [
              "CS015315000033",
              "福士 璃奈子",
              "1",
              "女性",
              "1983-03-17",
              "36",
              "135-0043",
              "東京都江東区塩浜**********",
              "S13015",
              "20141024",
              "4-20080219-3",
            ],
            [
              "CS023513000066",
              "神戸 そら",
              "1",
              "女性",
              "1961-12-17",
              "57",
              "210-0005",
              "神奈川県川崎市川崎区東田町**********",
              "S14023",
              "20150915",
              "5-20100524-9",
            ],
            [
              "CS035513000134",
              "市川 美帆",
              "1",
              "女性",
              "1960-03-27",
              "59",
              "156-0053",
              "東京都世田谷区桜**********",
              "S13035",
              "20150227",
              "8-20100711-9",
            ],
            [
              "CS001515000263",
              "高松 夏空",
              "1",
              "女性",
              "1962-11-09",
              "56",
              "144-0051",
              "東京都大田区西蒲田**********",
              "S13001",
              "20160812",
              "1-20100804-1",
            ],
            [
              "CS040314000027",
              "鶴田 きみまろ",
              "9",
              "不明",
              "1986-03-26",
              "33",
              "226-0027",
              "神奈川県横浜市緑区長津田**********",
              "S14040",
              "20150122",
              "2-20080426-4",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#D4D4D4"> *</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> customer </span><span style="color:#569CD6">WHERE</span><span style="color:#E6E6E6"> status_cd ~ </span><span style="color:#CE9178">\'[1-9]$\'</span><span style="color:#569CD6"> LIMIT</span><span style="color:#B5CEA8"> 10</span><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "15",
    title: "[あいまい検索]  部分一致4",
    description:
      "顧客データ（customer）から、ステータスコード（status_cd）の先頭がアルファベットのA〜Fで始まり、末尾が数字の1〜9で終わるデータを全項目抽出し、10件表示せよ。",
    solutions: [
      {
        sql: "SELECT * FROM customer WHERE status_cd ~ '^[A-F].*[1-9]$' LIMIT 10;",
        expectedResult: {
          fields: [
            "customer_id",
            "customer_name",
            "gender_cd",
            "gender",
            "birth_day",
            "age",
            "postal_cd",
            "address",
            "application_store_cd",
            "application_date",
            "status_cd",
          ],
          rows: [
            [
              "CS011215000048",
              "芦田 沙耶",
              "1",
              "女性",
              "1992-02-01",
              "27",
              "223-0062",
              "神奈川県横浜市港北区日吉本町**********",
              "S14011",
              "20150228",
              "C-20100421-9",
            ],
            [
              "CS022513000105",
              "島村 貴美子",
              "1",
              "女性",
              "1962-03-12",
              "57",
              "249-0002",
              "神奈川県逗子市山の根**********",
              "S14022",
              "20150320",
              "A-20091115-7",
            ],
            [
              "CS001515000096",
              "水野 陽子",
              "9",
              "不明",
              "1960-11-29",
              "58",
              "144-0053",
              "東京都大田区蒲田本町**********",
              "S13001",
              "20150614",
              "A-20100724-7",
            ],
            [
              "CS013615000053",
              "西脇 季衣",
              "1",
              "女性",
              "1953-10-18",
              "65",
              "261-0026",
              "千葉県千葉市美浜区幕張西**********",
              "S12013",
              "20150128",
              "B-20100329-6",
            ],
            [
              "CS020412000161",
              "小宮 薫",
              "1",
              "女性",
              "1974-05-21",
              "44",
              "174-0042",
              "東京都板橋区東坂下**********",
              "S13020",
              "20150822",
              "B-20081021-3",
            ],
            [
              "CS001215000097",
              "竹中 あさみ",
              "1",
              "女性",
              "1990-07-25",
              "28",
              "146-0095",
              "東京都大田区多摩川**********",
              "S13001",
              "20170315",
              "A-20100211-2",
            ],
            [
              "CS035212000007",
              "内村 恵梨香",
              "1",
              "女性",
              "1990-12-04",
              "28",
              "152-0023",
              "東京都目黒区八雲**********",
              "S13035",
              "20151013",
              "B-20101018-6",
            ],
            [
              "CS002515000386",
              "野田 コウ",
              "1",
              "女性",
              "1963-05-30",
              "55",
              "185-0013",
              "東京都国分寺市西恋ケ窪**********",
              "S13002",
              "20160410",
              "C-20100127-8",
            ],
            [
              "CS001615000372",
              "稲垣 寿々花",
              "1",
              "女性",
              "1956-10-29",
              "62",
              "144-0035",
              "東京都大田区南蒲田**********",
              "S13001",
              "20170403",
              "A-20100104-1",
            ],
            [
              "CS032512000121",
              "松井 知世",
              "1",
              "女性",
              "1962-09-04",
              "56",
              "210-0011",
              "神奈川県川崎市川崎区富士見**********",
              "S13032",
              "20150727",
              "A-20100103-5",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#D4D4D4"> *</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> customer </span><span style="color:#569CD6">WHERE</span><span style="color:#E6E6E6"> status_cd ~ </span><span style="color:#CE9178">\'^[A-F].*[1-9]$\'</span><span style="color:#569CD6"> LIMIT</span><span style="color:#B5CEA8"> 10</span><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "16",
    title: "[あいまい検索]  フォーマット一致",
    description:
      "店舗データ（store）から、電話番号（tel_no）が3桁-3桁-4桁のデータを全項目表示せよ。",
    solutions: [
      {
        sql: "SELECT * FROM store WHERE tel_no ~ '^[0-9]{3}-[0-9]{3}-[0-9]{4}$';",
        expectedResult: {
          fields: [
            "store_cd",
            "store_name",
            "prefecture_cd",
            "prefecture",
            "address",
            "address_kana",
            "tel_no",
            "longitude",
            "latitude",
            "floor_area",
          ],
          rows: [
            [
              "S12014",
              "千草台店",
              "12",
              "千葉県",
              "千葉県千葉市稲毛区千草台一丁目",
              "チバケンチバシイナゲクチグサダイイッチョウメ",
              "043-123-4003",
              "140.118",
              "35.63559",
              "1698.0",
            ],
            [
              "S13002",
              "国分寺店",
              "13",
              "東京都",
              "東京都国分寺市本多二丁目",
              "トウキョウトコクブンジシホンダニチョウメ",
              "042-123-4008",
              "139.4802",
              "35.70566",
              "1735.0",
            ],
            [
              "S14010",
              "菊名店",
              "14",
              "神奈川県",
              "神奈川県横浜市港北区菊名一丁目",
              "カナガワケンヨコハマシコウホククキクナイッチョウメ",
              "045-123-4032",
              "139.6326",
              "35.50049",
              "1732.0",
            ],
            [
              "S14033",
              "阿久和店",
              "14",
              "神奈川県",
              "神奈川県横浜市瀬谷区阿久和西一丁目",
              "カナガワケンヨコハマシセヤクアクワニシイッチョウメ",
              "045-123-4043",
              "139.4961",
              "35.45918",
              "1495.0",
            ],
            [
              "S14036",
              "相模原中央店",
              "14",
              "神奈川県",
              "神奈川県相模原市中央二丁目",
              "カナガワケンサガミハラシチュウオウニチョウメ",
              "042-123-4045",
              "139.3716",
              "35.57327",
              "1679.0",
            ],
            [
              "S14040",
              "長津田店",
              "14",
              "神奈川県",
              "神奈川県横浜市緑区長津田みなみ台五丁目",
              "カナガワケンヨコハマシミドリクナガツタミナミダイゴチョウメ",
              "045-123-4046",
              "139.4994",
              "35.52398",
              "1548.0",
            ],
            [
              "S14050",
              "阿久和西店",
              "14",
              "神奈川県",
              "神奈川県横浜市瀬谷区阿久和西一丁目",
              "カナガワケンヨコハマシセヤクアクワニシイッチョウメ",
              "045-123-4053",
              "139.4961",
              "35.45918",
              "1830.0",
            ],
            [
              "S13052",
              "森野店",
              "13",
              "東京都",
              "東京都町田市森野三丁目",
              "トウキョウトマチダシモリノサンチョウメ",
              "042-123-4030",
              "139.4383",
              "35.55293",
              "1087.0",
            ],
            [
              "S14028",
              "二ツ橋店",
              "14",
              "神奈川県",
              "神奈川県横浜市瀬谷区二ツ橋町",
              "カナガワケンヨコハマシセヤクフタツバシチョウ",
              "045-123-4042",
              "139.4963",
              "35.46304",
              "1574.0",
            ],
            [
              "S14012",
              "本牧和田店",
              "14",
              "神奈川県",
              "神奈川県横浜市中区本牧和田",
              "カナガワケンヨコハマシナカクホンモクワダ",
              "045-123-4034",
              "139.6582",
              "35.42156",
              "1341.0",
            ],
            [
              "S14046",
              "北山田店",
              "14",
              "神奈川県",
              "神奈川県横浜市都筑区北山田一丁目",
              "カナガワケンヨコハマシツヅキクキタヤマタイッチョウメ",
              "045-123-4049",
              "139.5916",
              "35.56189",
              "831.0",
            ],
            [
              "S14022",
              "逗子店",
              "14",
              "神奈川県",
              "神奈川県逗子市逗子一丁目",
              "カナガワケンズシシズシイッチョウメ",
              "046-123-4036",
              "139.5789",
              "35.29642",
              "1838.0",
            ],
            [
              "S14011",
              "日吉本町店",
              "14",
              "神奈川県",
              "神奈川県横浜市港北区日吉本町四丁目",
              "カナガワケンヨコハマシコウホククヒヨシホンチョウヨンチョウメ",
              "045-123-4033",
              "139.6316",
              "35.54655",
              "890.0",
            ],
            [
              "S13016",
              "小金井店",
              "13",
              "東京都",
              "東京都小金井市本町一丁目",
              "トウキョウトコガネイシホンチョウイッチョウメ",
              "042-123-4015",
              "139.5094",
              "35.70018",
              "1399.0",
            ],
            [
              "S14034",
              "川崎野川店",
              "14",
              "神奈川県",
              "神奈川県川崎市宮前区野川",
              "カナガワケンカワサキシミヤマエクノガワ",
              "044-123-4044",
              "139.5998",
              "35.57693",
              "1318.0",
            ],
            [
              "S14048",
              "中川中央店",
              "14",
              "神奈川県",
              "神奈川県横浜市都筑区中川中央二丁目",
              "カナガワケンヨコハマシツヅキクナカガワチュウオウニチョウメ",
              "045-123-4051",
              "139.5758",
              "35.54912",
              "1657.0",
            ],
            [
              "S12007",
              "佐倉店",
              "12",
              "千葉県",
              "千葉県佐倉市上志津",
              "チバケンサクラシカミシヅ",
              "043-123-4001",
              "140.1452",
              "35.71872",
              "1895.0",
            ],
            [
              "S14026",
              "辻堂西海岸店",
              "14",
              "神奈川県",
              "神奈川県藤沢市辻堂西海岸二丁目",
              "カナガワケンフジサワシツジドウニシカイガンニチョウメ",
              "046-123-4040",
              "139.4466",
              "35.32464",
              "1732.0",
            ],
            [
              "S13041",
              "八王子店",
              "13",
              "東京都",
              "東京都八王子市大塚",
              "トウキョウトハチオウジシオオツカ",
              "042-123-4026",
              "139.4235",
              "35.63787",
              "810.0",
            ],
            [
              "S14049",
              "川崎大師店",
              "14",
              "神奈川県",
              "神奈川県川崎市川崎区中瀬三丁目",
              "カナガワケンカワサキシカワサキクナカゼサンチョウメ",
              "044-123-4052",
              "139.7327",
              "35.53759",
              "962.0",
            ],
            [
              "S14023",
              "川崎店",
              "14",
              "神奈川県",
              "神奈川県川崎市川崎区本町二丁目",
              "カナガワケンカワサキシカワサキクホンチョウニチョウメ",
              "044-123-4037",
              "139.7028",
              "35.53599",
              "1804.0",
            ],
            [
              "S13018",
              "清瀬店",
              "13",
              "東京都",
              "東京都清瀬市松山一丁目",
              "トウキョウトキヨセシマツヤマイッチョウメ",
              "042-123-4017",
              "139.5178",
              "35.76885",
              "1220.0",
            ],
            [
              "S14027",
              "南藤沢店",
              "14",
              "神奈川県",
              "神奈川県藤沢市南藤沢",
              "カナガワケンフジサワシミナミフジサワ",
              "046-123-4041",
              "139.4896",
              "35.33762",
              "1521.0",
            ],
            [
              "S14021",
              "伊勢原店",
              "14",
              "神奈川県",
              "神奈川県伊勢原市伊勢原四丁目",
              "カナガワケンイセハラシイセハラヨンチョウメ",
              "046-123-4035",
              "139.3129",
              "35.40169",
              "962.0",
            ],
            [
              "S14047",
              "相模原店",
              "14",
              "神奈川県",
              "神奈川県相模原市千代田六丁目",
              "カナガワケンサガミハラシチヨダロクチョウメ",
              "042-123-4050",
              "139.3748",
              "35.55959",
              "1047.0",
            ],
            [
              "S12013",
              "習志野店",
              "12",
              "千葉県",
              "千葉県習志野市芝園一丁目",
              "チバケンナラシノシシバゾノイッチョウメ",
              "047-123-4002",
              "140.022",
              "35.66122",
              "808.0",
            ],
            [
              "S14042",
              "新山下店",
              "14",
              "神奈川県",
              "神奈川県横浜市中区新山下二丁目",
              "カナガワケンヨコハマシナカクシンヤマシタニチョウメ",
              "045-123-4047",
              "139.6593",
              "35.43894",
              "1044.0",
            ],
            [
              "S12030",
              "八幡店",
              "12",
              "千葉県",
              "千葉県市川市八幡三丁目",
              "チバケンイチカワシヤワタサンチョウメ",
              "047-123-4005",
              "139.924",
              "35.72318",
              "1162.0",
            ],
            [
              "S14025",
              "大和店",
              "14",
              "神奈川県",
              "神奈川県大和市下和田",
              "カナガワケンヤマトシシモワダ",
              "046-123-4039",
              "139.468",
              "35.43414",
              "1011.0",
            ],
            [
              "S14045",
              "厚木店",
              "14",
              "神奈川県",
              "神奈川県厚木市中町二丁目",
              "カナガワケンアツギシナカチョウニチョウメ",
              "046-123-4048",
              "139.3651",
              "35.44182",
              "980.0",
            ],
            [
              "S12029",
              "東野店",
              "12",
              "千葉県",
              "千葉県浦安市東野一丁目",
              "チバケンウラヤスシヒガシノイッチョウメ",
              "047-123-4004",
              "139.8968",
              "35.65086",
              "1101.0",
            ],
            [
              "S12053",
              "高洲店",
              "12",
              "千葉県",
              "千葉県浦安市高洲五丁目",
              "チバケンウラヤスシタカスゴチョウメ",
              "047-123-4006",
              "139.9176",
              "35.63755",
              "1555.0",
            ],
            [
              "S14024",
              "三田店",
              "14",
              "神奈川県",
              "神奈川県川崎市多摩区三田四丁目",
              "カナガワケンカワサキシタマクミタヨンチョウメ",
              "044-123-4038",
              "139.5424",
              "35.6077",
              "972.0",
            ],
            [
              "S14006",
              "葛が谷店",
              "14",
              "神奈川県",
              "神奈川県横浜市都筑区葛が谷",
              "カナガワケンヨコハマシツヅキククズガヤ",
              "045-123-4031",
              "139.5633",
              "35.53573",
              "1886.0",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#D4D4D4"> *</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> store </span><span style="color:#569CD6">WHERE</span><span style="color:#E6E6E6"> tel_no ~ </span><span style="color:#CE9178">\'^[0-9]{3}-[0-9]{3}-[0-9]{4}$\'</span><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "17",
    title: "[ソート]  並び替え(昇順)",
    description:
      "顧客データ（customer）を生年月日（birth_day）で高齢順にソートし、先頭から全項目を10件表示せよ。",
    solutions: [
      {
        sql: "SELECT * FROM customer ORDER BY birth_day LIMIT 10;",
        expectedResult: {
          fields: [
            "customer_id",
            "customer_name",
            "gender_cd",
            "gender",
            "birth_day",
            "age",
            "postal_cd",
            "address",
            "application_store_cd",
            "application_date",
            "status_cd",
          ],
          rows: [
            [
              "CS003813000014",
              "村山 菜々美",
              "1",
              "女性",
              "1928-11-26",
              "90",
              "182-0007",
              "東京都調布市菊野台**********",
              "S13003",
              "20160214",
              "0-00000000-0",
            ],
            [
              "CS026813000004",
              "吉村 朝陽",
              "1",
              "女性",
              "1928-12-14",
              "90",
              "251-0043",
              "神奈川県藤沢市辻堂元町**********",
              "S14026",
              "20150723",
              "0-00000000-0",
            ],
            [
              "CS018811000003",
              "熊沢 美里",
              "1",
              "女性",
              "1929-01-07",
              "90",
              "204-0004",
              "東京都清瀬市野塩**********",
              "S13018",
              "20150403",
              "0-00000000-0",
            ],
            [
              "CS027803000004",
              "内村 拓郎",
              "0",
              "男性",
              "1929-01-12",
              "90",
              "251-0031",
              "神奈川県藤沢市鵠沼藤が谷**********",
              "S14027",
              "20151227",
              "0-00000000-0",
            ],
            [
              "CS013801000003",
              "天野 拓郎",
              "0",
              "男性",
              "1929-01-15",
              "90",
              "274-0824",
              "千葉県船橋市前原東**********",
              "S12013",
              "20160120",
              "0-00000000-0",
            ],
            [
              "CS001814000022",
              "鶴田 里穂",
              "1",
              "女性",
              "1929-01-28",
              "90",
              "144-0045",
              "東京都大田区南六郷**********",
              "S13001",
              "20161012",
              "A-20090415-7",
            ],
            [
              "CS016815000002",
              "山元 美紀",
              "1",
              "女性",
              "1929-02-22",
              "90",
              "184-0005",
              "東京都小金井市桜町**********",
              "S13016",
              "20150629",
              "C-20090923-C",
            ],
            [
              "CS009815000003",
              "中田 里穂",
              "1",
              "女性",
              "1929-04-08",
              "89",
              "154-0014",
              "東京都世田谷区新町**********",
              "S13009",
              "20150421",
              "D-20091021-E",
            ],
            [
              "CS012813000013",
              "宇野 南朋",
              "1",
              "女性",
              "1929-04-09",
              "89",
              "231-0806",
              "神奈川県横浜市中区本牧町**********",
              "S14012",
              "20150712",
              "0-00000000-0",
            ],
            [
              "CS005813000015",
              "金谷 恵梨香",
              "1",
              "女性",
              "1929-04-09",
              "89",
              "165-0032",
              "東京都中野区鷺宮**********",
              "S13005",
              "20150506",
              "0-00000000-0",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#D4D4D4"> *</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> customer </span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> birth_day </span><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "18",
    title: "[ソート]  並び替え(降順)",
    description:
      "顧客データ（customer）を生年月日（birth_day）で若い順にソートし、先頭から全項目を10件表示せよ。",
    solutions: [
      {
        sql: "SELECT * FROM customer ORDER BY birth_day DESC LIMIT 10;",
        expectedResult: {
          fields: [
            "customer_id",
            "customer_name",
            "gender_cd",
            "gender",
            "birth_day",
            "age",
            "postal_cd",
            "address",
            "application_store_cd",
            "application_date",
            "status_cd",
          ],
          rows: [
            [
              "CS035114000004",
              "大村 美里",
              "1",
              "女性",
              "2007-11-25",
              "11",
              "156-0053",
              "東京都世田谷区桜**********",
              "S13035",
              "20150619",
              "6-20091205-6",
            ],
            [
              "CS022103000002",
              "福山 はじめ",
              "9",
              "不明",
              "2007-10-02",
              "11",
              "249-0006",
              "神奈川県逗子市逗子**********",
              "S14022",
              "20160909",
              "0-00000000-0",
            ],
            [
              "CS002113000009",
              "柴田 真悠子",
              "1",
              "女性",
              "2007-09-17",
              "11",
              "184-0014",
              "東京都小金井市貫井南町**********",
              "S13002",
              "20160304",
              "0-00000000-0",
            ],
            [
              "CS004115000014",
              "松井 京子",
              "1",
              "女性",
              "2007-08-09",
              "11",
              "165-0031",
              "東京都中野区上鷺宮**********",
              "S13004",
              "20161120",
              "1-20081231-1",
            ],
            [
              "CS002114000010",
              "山内 遥",
              "1",
              "女性",
              "2007-06-03",
              "11",
              "184-0015",
              "東京都小金井市貫井北町**********",
              "S13002",
              "20160920",
              "6-20100510-1",
            ],
            [
              "CS025115000002",
              "小柳 夏希",
              "1",
              "女性",
              "2007-04-18",
              "11",
              "245-0018",
              "神奈川県横浜市泉区上飯田町**********",
              "S14025",
              "20160116",
              "D-20100913-D",
            ],
            [
              "CS002113000025",
              "広末 まなみ",
              "1",
              "女性",
              "2007-03-30",
              "12",
              "184-0015",
              "東京都小金井市貫井北町**********",
              "S13002",
              "20171030",
              "0-00000000-0",
            ],
            [
              "CS033112000003",
              "長野 美紀",
              "1",
              "女性",
              "2007-03-22",
              "12",
              "245-0051",
              "神奈川県横浜市戸塚区名瀬町**********",
              "S14033",
              "20150606",
              "0-00000000-0",
            ],
            [
              "CS007115000006",
              "福岡 瞬",
              "1",
              "女性",
              "2007-03-10",
              "12",
              "285-0845",
              "千葉県佐倉市西志津**********",
              "S12007",
              "20151118",
              "F-20101016-F",
            ],
            [
              "CS014113000008",
              "矢口 莉緒",
              "1",
              "女性",
              "2007-03-05",
              "12",
              "260-0041",
              "千葉県千葉市中央区東千葉**********",
              "S12014",
              "20150622",
              "3-20091108-6",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#D4D4D4"> *</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> customer </span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> birth_day </span><span style="color:#569CD6">DESC</span><span style="color:#569CD6"> LIMIT</span><span style="color:#B5CEA8"> 10</span><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "19",
    title: "[ソート]  順位付け(同一順位あり)",
    description:
      "レシート明細データ（receipt）に対し、1件あたりの売上金額（amount）が高い順にランクを付与し、先頭から10件表示せよ。項目は顧客ID（customer_id）、売上金額（amount）、付与したランクを表示させること。なお、売上金額（amount）が等しい場合は同一順位を付与するものとし、顧客ID (customer_id)の昇順に並べる。",
    solutions: [
      {
        sql: "SELECT\n    customer_id,\n    amount,\n    RANK() OVER(ORDER BY amount DESC) AS ranking \nFROM receipt\nORDER BY amount DESC, customer_id ASC\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "amount", "ranking"],
          rows: [
            ["CS011415000006", "10925", "1"],
            ["ZZ000000000000", "6800", "2"],
            ["CS028605000002", "5780", "3"],
            ["CS015515000034", "5480", "4"],
            ["ZZ000000000000", "5480", "4"],
            ["ZZ000000000000", "5480", "4"],
            ["CS021515000089", "5440", "7"],
            ["ZZ000000000000", "5440", "7"],
            ["CS001412000160", "5280", "9"],
            ["CS002415000728", "5280", "9"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount,</span></span>\n<span class="line"><span style="color:#DCDCAA">    RANK</span><span style="color:#E6E6E6">() </span><span style="color:#569CD6">OVER</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">DESC</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> ranking </span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">DESC</span><span style="color:#E6E6E6">, customer_id </span><span style="color:#569CD6">ASC</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "20",
    title: "[ソート]  順位付け(同一順位なし)",
    description:
      "レシート明細データ（receipt）に対し、1件あたりの売上金額（amount）が高い順、店舗コード (store_cd)の昇順にランクを付与し、先頭から10件表示せよ。項目は顧客ID（customer_id）、売上金額（amount）、付与したランクを表示させること。なお、売上金額（amount）が等しい場合でも別順位を付与すること。",
    solutions: [
      {
        sql: "SELECT\n    customer_id,\n    amount,\n    ROW_NUMBER() OVER(ORDER BY amount DESC, store_cd) AS ranking \nFROM receipt\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "amount", "ranking"],
          rows: [
            ["CS011415000006", "10925", "1"],
            ["ZZ000000000000", "6800", "2"],
            ["CS028605000002", "5780", "3"],
            ["ZZ000000000000", "5480", "4"],
            ["CS015515000034", "5480", "5"],
            ["ZZ000000000000", "5480", "6"],
            ["ZZ000000000000", "5440", "7"],
            ["CS021515000089", "5440", "8"],
            ["ZZ000000000000", "5280", "9"],
            ["CS030515000189", "5280", "10"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount,</span></span>\n<span class="line"><span style="color:#DCDCAA">    ROW_NUMBER</span><span style="color:#E6E6E6">() </span><span style="color:#569CD6">OVER</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">DESC</span><span style="color:#E6E6E6">, store_cd) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> ranking </span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "21",
    title: "[集計]  カウント",
    description: "レシート明細データ（receipt）に対し、件数をカウントせよ。",
    solutions: [
      {
        sql: "-- コード例1\nSELECT COUNT(1) FROM receipt;",
        expectedResult: { fields: ["count"], rows: [["104681"]] },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- コード例1</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#DCDCAA"> COUNT</span><span style="color:#E6E6E6">(</span><span style="color:#B5CEA8">1</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt;</span></span></code></pre>',
      },
      {
        sql: "-- コード例2（*でもOK）\nSELECT COUNT(*) FROM receipt;",
        expectedResult: { fields: ["count"], rows: [["104681"]] },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- コード例2（*でもOK）</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#DCDCAA"> COUNT</span><span style="color:#E6E6E6">(</span><span style="color:#D4D4D4">*</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "22",
    title: "[集計]  カウント(ユニーク件数)",
    description:
      "レシート明細データ（receipt）の顧客ID（customer_id）に対し、ユニーク件数をカウントせよ。",
    solutions: [
      {
        sql: "SELECT\n    COUNT(DISTINCT customer_id)\nFROM receipt\n;",
        expectedResult: { fields: ["count"], rows: [["8307"]] },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#DCDCAA">    COUNT</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">DISTINCT</span><span style="color:#E6E6E6"> customer_id)</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "23",
    title: "[集計]  合計",
    description:
      "レシート明細データ（receipt）に対し、店舗コード（store_cd）ごとに売上金額（amount）と売上数量（quantity）を合計せよ。",
    solutions: [
      {
        sql: "SELECT store_cd\n    , SUM(amount) AS amount\n    , SUM(quantity) AS quantity\nFROM receipt\ngroup by store_cd\n;",
        expectedResult: {
          fields: ["store_cd", "amount", "quantity"],
          rows: [
            ["S12007", "638761", "2099"],
            ["S13017", "748221", "2376"],
            ["S13043", "587895", "1881"],
            ["S13052", "100314", "250"],
            ["S13016", "793773", "2432"],
            ["S14027", "714550", "2303"],
            ["S13009", "808870", "2486"],
            ["S14022", "651328", "2047"],
            ["S13019", "827833", "2541"],
            ["S13039", "611888", "1981"],
            ["S14046", "412646", "1354"],
            ["S13003", "764294", "2197"],
            ["S14028", "786145", "2458"],
            ["S14045", "458484", "1398"],
            ["S13002", "727821", "2340"],
            ["S14042", "534689", "1935"],
            ["S13004", "779373", "2390"],
            ["S13038", "708884", "2337"],
            ["S12014", "725167", "2358"],
            ["S14021", "699511", "2231"],
            ["S14006", "712839", "2284"],
            ["S13001", "811936", "2347"],
            ["S14023", "727630", "2258"],
            ["S14025", "755581", "2394"],
            ["S13035", "715869", "2219"],
            ["S14048", "234276", "769"],
            ["S14012", "720600", "2412"],
            ["S14024", "736323", "2417"],
            ["S13041", "728266", "2233"],
            ["S14026", "824537", "2503"],
            ["S14010", "790361", "2290"],
            ["S13015", "780873", "2248"],
            ["S13008", "809288", "2491"],
            ["S14049", "230808", "788"],
            ["S14050", "167090", "580"],
            ["S13031", "705968", "2336"],
            ["S12013", "787513", "2425"],
            ["S13044", "520764", "1729"],
            ["S14033", "725318", "2282"],
            ["S12029", "794741", "2555"],
            ["S13037", "693087", "2344"],
            ["S12030", "684402", "2403"],
            ["S13032", "790501", "2491"],
            ["S14034", "653681", "2024"],
            ["S14040", "701858", "2233"],
            ["S13005", "629876", "2004"],
            ["S14047", "338329", "1041"],
            ["S14011", "805724", "2434"],
            ["S13018", "790535", "2562"],
            ["S13020", "796383", "2383"],
            ["S13051", "107452", "354"],
            ["S14036", "203694", "635"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#E6E6E6"> store_cd</span></span>\n<span class="line"><span style="color:#E6E6E6">    , </span><span style="color:#DCDCAA">SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount</span></span>\n<span class="line"><span style="color:#E6E6E6">    , </span><span style="color:#DCDCAA">SUM</span><span style="color:#E6E6E6">(quantity) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> quantity</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">group by</span><span style="color:#E6E6E6"> store_cd</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "24",
    title: "[集計]  最大値",
    description:
      "レシート明細データ（receipt）に対し、顧客ID（customer_id）ごとに最も新しい売上年月日（sales_ymd）を求め、10件表示せよ。",
    solutions: [
      {
        sql: "SELECT\n    customer_id,\n    MAX(sales_ymd)\nFROM receipt\nGROUP BY customer_id\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "max"],
          rows: [
            ["CS001311000059", "20180211"],
            ["CS004614000122", "20181228"],
            ["CS003512000043", "20180106"],
            ["CS011615000061", "20190503"],
            ["CS029212000033", "20180621"],
            ["CS007515000119", "20190511"],
            ["CS034515000123", "20190708"],
            ["CS004315000058", "20170517"],
            ["CS026414000014", "20190720"],
            ["CS001615000099", "20170729"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">    MAX</span><span style="color:#E6E6E6">(sales_ymd)</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">GROUP BY</span><span style="color:#E6E6E6"> customer_id</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "25",
    title: "[集計]  最小値",
    description:
      "レシート明細データ（receipt）に対し、顧客ID（customer_id）ごとに最も古い売上年月日（sales_ymd）を求め、10件表示せよ。",
    solutions: [
      {
        sql: "SELECT\n    customer_id,\n    MIN(sales_ymd)\nFROM receipt\nGROUP BY customer_id\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "min"],
          rows: [
            ["CS001311000059", "20180211"],
            ["CS004614000122", "20181228"],
            ["CS003512000043", "20180106"],
            ["CS011615000061", "20190503"],
            ["CS029212000033", "20170318"],
            ["CS007515000119", "20170201"],
            ["CS034515000123", "20170527"],
            ["CS004315000058", "20170517"],
            ["CS026414000014", "20170718"],
            ["CS001615000099", "20170729"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">    MIN</span><span style="color:#E6E6E6">(sales_ymd)</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">GROUP BY</span><span style="color:#E6E6E6"> customer_id</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "26",
    title: "[集計]  絞り込み1",
    description:
      "レシート明細データ（receipt）に対し、顧客ID（customer_id）ごとに最も新しい売上年月日（sales_ymd）と古い売上年月日を求め、両者が異なるデータを10件表示せよ。",
    solutions: [
      {
        sql: "SELECT\n    customer_id,\n    MAX(sales_ymd),\n    MIN(sales_ymd)\nFROM receipt\nGROUP BY customer_id\nHAVING MAX(sales_ymd) != MIN(sales_ymd)\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "max", "min"],
          rows: [
            ["CS029212000033", "20180621", "20170318"],
            ["CS007515000119", "20190511", "20170201"],
            ["CS034515000123", "20190708", "20170527"],
            ["CS026414000014", "20190720", "20170718"],
            ["CS010515000082", "20181204", "20180518"],
            ["CS019315000045", "20170920", "20170423"],
            ["CS008513000099", "20190308", "20170722"],
            ["CS007615000070", "20191025", "20170929"],
            ["CS025415000155", "20191026", "20170314"],
            ["CS016414000063", "20190617", "20170109"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">    MAX</span><span style="color:#E6E6E6">(sales_ymd),</span></span>\n<span class="line"><span style="color:#DCDCAA">    MIN</span><span style="color:#E6E6E6">(sales_ymd)</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">GROUP BY</span><span style="color:#E6E6E6"> customer_id</span></span>\n<span class="line"><span style="color:#569CD6">HAVING</span><span style="color:#DCDCAA"> MAX</span><span style="color:#E6E6E6">(sales_ymd) </span><span style="color:#D4D4D4">!=</span><span style="color:#DCDCAA"> MIN</span><span style="color:#E6E6E6">(sales_ymd)</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "27",
    title: "[集計]  平均",
    description:
      "レシート明細データ（receipt）に対し、店舗コード（store_cd）ごとに売上金額（amount）の平均を計算し、降順でTOP5を表示せよ。",
    solutions: [
      {
        sql: "SELECT\n    store_cd,\n    AVG(amount) AS avg_amount\nFROM receipt\nGROUP BY store_cd\nORDER BY avg_amount DESC\nLIMIT 5\n;",
        expectedResult: {
          fields: ["store_cd", "avg_amount"],
          rows: [
            ["S13052", "402.8674698795180723"],
            ["S13015", "351.1119604316546763"],
            ["S13003", "350.9155188246097337"],
            ["S14010", "348.7912621359223301"],
            ["S13001", "348.4703862660944206"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    store_cd,</span></span>\n<span class="line"><span style="color:#DCDCAA">    AVG</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> avg_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">GROUP BY</span><span style="color:#E6E6E6"> store_cd</span></span>\n<span class="line"><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> avg_amount </span><span style="color:#569CD6">DESC</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 5</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "28",
    title: "[集計]  中央値",
    description:
      "レシート明細データ（receipt）に対し、店舗コード（store_cd）ごとに売上金額（amount）の中央値を計算し、降順でTOP5を表示せよ。",
    solutions: [
      {
        sql: "SELECT \n    store_cd, \n    PERCENTILE_CONT(0.5) WITHIN GROUP(ORDER BY amount) AS amount_50per\nFROM receipt\nGROUP BY store_cd\nORDER BY amount_50per DESC\nLIMIT 5\n;",
        expectedResult: {
          fields: ["store_cd", "amount_50per"],
          rows: [
            ["S13052", "190"],
            ["S14010", "188"],
            ["S14050", "185"],
            ["S13003", "180"],
            ["S13018", "180"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#E6E6E6"> </span></span>\n<span class="line"><span style="color:#E6E6E6">    store_cd, </span></span>\n<span class="line"><span style="color:#DCDCAA">    PERCENTILE_CONT</span><span style="color:#E6E6E6">(</span><span style="color:#B5CEA8">0</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">5</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">WITHIN</span><span style="color:#DCDCAA"> GROUP</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount_50per</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">GROUP BY</span><span style="color:#E6E6E6"> store_cd</span></span>\n<span class="line"><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> amount_50per </span><span style="color:#569CD6">DESC</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 5</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "29",
    title: "[集計]  最頻値",
    description:
      "レシート明細データ（receipt）に対し、店舗コード（store_cd）ごとに商品コード（product_cd）の最頻値を求め、10件表示させよ。",
    solutions: [
      {
        sql: "-- コード例1: window関数や分析関数で最頻値を集計する\nWITH product_cnt AS (\n    SELECT\n        store_cd,\n        product_cd,\n        COUNT(1) AS mode_cnt\n    FROM receipt\n    GROUP BY\n        store_cd,\n        product_cd\n),\nproduct_mode AS (\n    SELECT\n        store_cd,\n        product_cd,\n        mode_cnt,\n        RANK() OVER(PARTITION BY store_cd ORDER BY mode_cnt DESC) AS rnk\n    FROM product_cnt\n)\nSELECT\n    store_cd,\n    product_cd,\n    mode_cnt\nFROM product_mode\nWHERE\n    rnk = 1\nORDER BY\n    store_cd,\n    product_cd\nLIMIT 10\n;",
        expectedResult: {
          fields: ["store_cd", "product_cd", "mode_cnt"],
          rows: [
            ["S12007", "P060303001", "72"],
            ["S12013", "P060303001", "107"],
            ["S12014", "P060303001", "65"],
            ["S12029", "P060303001", "92"],
            ["S12030", "P060303001", "115"],
            ["S13001", "P060303001", "67"],
            ["S13002", "P060303001", "78"],
            ["S13003", "P071401001", "65"],
            ["S13004", "P060303001", "88"],
            ["S13005", "P040503001", "36"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- コード例1: window関数や分析関数で最頻値を集計する</span></span>\n<span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> product_cnt </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        store_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">        product_cd,</span></span>\n<span class="line"><span style="color:#DCDCAA">        COUNT</span><span style="color:#E6E6E6">(</span><span style="color:#B5CEA8">1</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> mode_cnt</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        store_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">        product_cd</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">product_mode </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        store_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">        product_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">        mode_cnt,</span></span>\n<span class="line"><span style="color:#DCDCAA">        RANK</span><span style="color:#E6E6E6">() </span><span style="color:#569CD6">OVER</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">PARTITION</span><span style="color:#569CD6"> BY</span><span style="color:#E6E6E6"> store_cd </span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> mode_cnt </span><span style="color:#569CD6">DESC</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> rnk</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> product_cnt</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    store_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    product_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    mode_cnt</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> product_mode</span></span>\n<span class="line"><span style="color:#569CD6">WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">    rnk </span><span style="color:#D4D4D4">=</span><span style="color:#B5CEA8"> 1</span></span>\n<span class="line"><span style="color:#569CD6">ORDER BY</span></span>\n<span class="line"><span style="color:#E6E6E6">    store_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    product_cd</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
      {
        sql: "-- コード例2: MODE()を使う簡易ケース（早いが最頻値が複数の場合は一つだけ選ばれる）\nSELECT\n    store_cd,\n    MODE() WITHIN GROUP(ORDER BY product_cd)\nFROM receipt\nGROUP BY store_cd\nORDER BY store_cd\nLIMIT 10\n;",
        expectedResult: {
          fields: ["store_cd", "mode"],
          rows: [
            ["S12007", "P060303001"],
            ["S12013", "P060303001"],
            ["S12014", "P060303001"],
            ["S12029", "P060303001"],
            ["S12030", "P060303001"],
            ["S13001", "P060303001"],
            ["S13002", "P060303001"],
            ["S13003", "P071401001"],
            ["S13004", "P060303001"],
            ["S13005", "P040503001"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- コード例2: MODE()を使う簡易ケース（早いが最頻値が複数の場合は一つだけ選ばれる）</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    store_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    MODE() </span><span style="color:#569CD6">WITHIN</span><span style="color:#DCDCAA"> GROUP</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> product_cd)</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">GROUP BY</span><span style="color:#E6E6E6"> store_cd</span></span>\n<span class="line"><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> store_cd</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "30",
    title: "[集計]  分散",
    description:
      "レシート明細データ（receipt）に対し、店舗コード（store_cd）ごとに売上金額（amount）の分散を計算し、降順で5件表示せよ。",
    solutions: [
      {
        sql: "SELECT\n    store_cd,\n    VAR_POP(amount) AS vars_amount\nFROM receipt\nGROUP BY store_cd\nORDER BY vars_amount DESC \nLIMIT 5\n;",
        expectedResult: {
          fields: ["store_cd", "vars_amount"],
          rows: [
            ["S13052", "440088.701311269173"],
            ["S14011", "306314.558163888889"],
            ["S14034", "296920.081011283873"],
            ["S13001", "295431.993329035348"],
            ["S13015", "295294.361115940880"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    store_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    VAR_POP(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> vars_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">GROUP BY</span><span style="color:#E6E6E6"> store_cd</span></span>\n<span class="line"><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> vars_amount </span><span style="color:#569CD6">DESC</span><span style="color:#E6E6E6"> </span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 5</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "31",
    title: "[集計]  標準偏差",
    description:
      "レシート明細データ（receipt）に対し、店舗コード（store_cd）ごとに売上金額（amount）の標準偏差を計算し、降順で5件表示せよ。",
    solutions: [
      {
        sql: "SELECT\n    store_cd,\n    STDDEV_POP(amount) as stds_amount\nFROM receipt\nGROUP BY store_cd\nORDER BY stds_amount DESC\nLIMIT 5\n;",
        expectedResult: {
          fields: ["store_cd", "stds_amount"],
          rows: [
            ["S13052", "663.391815830787"],
            ["S14011", "553.456916267101"],
            ["S14034", "544.903735545357"],
            ["S13001", "543.536561170484"],
            ["S13015", "543.409938366921"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    store_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    STDDEV_POP(amount) </span><span style="color:#569CD6">as</span><span style="color:#E6E6E6"> stds_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">GROUP BY</span><span style="color:#E6E6E6"> store_cd</span></span>\n<span class="line"><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> stds_amount </span><span style="color:#569CD6">DESC</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 5</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "32",
    title: "[集計]  パーセンタイル",
    description:
      "レシート明細データ（receipt）の売上金額（amount）について、25％刻みでパーセンタイル値を求めよ。",
    solutions: [
      {
        sql: "SELECT\n    PERCENTILE_CONT(0.25) WITHIN GROUP(ORDER BY amount) AS amount_25per,\n    PERCENTILE_CONT(0.50) WITHIN GROUP(ORDER BY amount) AS amount_50per,\n    PERCENTILE_CONT(0.75) WITHIN GROUP(ORDER BY amount) AS amount_75per,\n    PERCENTILE_CONT(1.0) WITHIN GROUP(ORDER BY amount) AS amount_100per\nFROM receipt\n;",
        expectedResult: {
          fields: [
            "amount_25per",
            "amount_50per",
            "amount_75per",
            "amount_100per",
          ],
          rows: [["102", "170", "288", "10925"]],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#DCDCAA">    PERCENTILE_CONT</span><span style="color:#E6E6E6">(</span><span style="color:#B5CEA8">0</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">25</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">WITHIN</span><span style="color:#DCDCAA"> GROUP</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount_25per,</span></span>\n<span class="line"><span style="color:#DCDCAA">    PERCENTILE_CONT</span><span style="color:#E6E6E6">(</span><span style="color:#B5CEA8">0</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">50</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">WITHIN</span><span style="color:#DCDCAA"> GROUP</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount_50per,</span></span>\n<span class="line"><span style="color:#DCDCAA">    PERCENTILE_CONT</span><span style="color:#E6E6E6">(</span><span style="color:#B5CEA8">0</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">75</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">WITHIN</span><span style="color:#DCDCAA"> GROUP</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount_75per,</span></span>\n<span class="line"><span style="color:#DCDCAA">    PERCENTILE_CONT</span><span style="color:#E6E6E6">(</span><span style="color:#B5CEA8">1</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">0</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">WITHIN</span><span style="color:#DCDCAA"> GROUP</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount_100per</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "33",
    title: "[集計]  絞り込み2",
    description:
      "レシート明細データ（receipt）に対し、店舗コード（store_cd）ごとに売上金額（amount）の平均を計算し、330以上のものを抽出せよ。",
    solutions: [
      {
        sql: "SELECT\n    store_cd,\n    AVG(amount) AS avg_amount\nFROM receipt\nGROUP BY store_cd\nHAVING\n    AVG(amount) >= 330\n;",
        expectedResult: {
          fields: ["store_cd", "avg_amount"],
          rows: [
            ["S13052", "402.8674698795180723"],
            ["S13019", "330.2086158755484643"],
            ["S13003", "350.9155188246097337"],
            ["S14045", "330.0820734341252700"],
            ["S13004", "330.9439490445859873"],
            ["S13001", "348.4703862660944206"],
            ["S14026", "332.3405884723901653"],
            ["S14010", "348.7912621359223301"],
            ["S13015", "351.1119604316546763"],
            ["S12013", "330.1941299790356394"],
            ["S14047", "330.0770731707317073"],
            ["S14011", "335.7183333333333333"],
            ["S13020", "337.8799321170980059"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    store_cd,</span></span>\n<span class="line"><span style="color:#DCDCAA">    AVG</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> avg_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">GROUP BY</span><span style="color:#E6E6E6"> store_cd</span></span>\n<span class="line"><span style="color:#569CD6">HAVING</span></span>\n<span class="line"><span style="color:#DCDCAA">    AVG</span><span style="color:#E6E6E6">(amount) </span><span style="color:#D4D4D4">>=</span><span style="color:#B5CEA8"> 330</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "34",
    title: "[集計]  サブクエリ1",
    description:
      'レシート明細データ（receipt）に対し、顧客ID（customer_id）ごとに売上金額（amount）を合計して全顧客の平均を求めよ。ただし、顧客IDが"Z"から始まるものは非会員を表すため、除外して計算すること。',
    solutions: [
      {
        sql: "WITH customer_amount AS (\n    SELECT\n        customer_id,\n        SUM(amount) AS sum_amount\n    FROM receipt\n    WHERE\n        customer_id NOT LIKE 'Z%'\n    GROUP BY customer_id\n)\nSELECT\n    AVG(sum_amount)\nFROM customer_amount\n;",
        expectedResult: { fields: ["avg"], rows: [["2547.7422345292559595"]] },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> customer_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">    WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id </span><span style="color:#569CD6">NOT</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'Z%\'</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span><span style="color:#E6E6E6"> customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#DCDCAA">    AVG</span><span style="color:#E6E6E6">(sum_amount)</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> customer_amount</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "35",
    title: "[集計]  サブクエリ2",
    description:
      'レシート明細データ（receipt）に対し、顧客ID（customer_id）ごとに売上金額（amount）を合計して全顧客の平均を求め、平均以上に買い物をしている顧客を抽出し、10件表示せよ。ただし、顧客IDが"Z"から始まるものは非会員を表すため、除外して計算すること。',
    solutions: [
      {
        sql: "WITH customer_amount AS (\n    SELECT\n        customer_id,\n        SUM(amount) AS sum_amount\n    FROM receipt\n    WHERE\n        customer_id NOT LIKE 'Z%'\n    GROUP BY customer_id\n)\nSELECT\n    customer_id,\n    sum_amount\nFROM customer_amount\nWHERE\n    sum_amount >= (\n        SELECT\n            AVG(sum_amount)\n        FROM customer_amount\n    )\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "sum_amount"],
          rows: [
            ["CS029212000033", "3604"],
            ["CS007515000119", "7157"],
            ["CS034515000123", "3699"],
            ["CS026414000014", "6671"],
            ["CS007615000070", "2975"],
            ["CS016414000063", "6207"],
            ["CS012514000018", "2562"],
            ["CS029515000142", "3420"],
            ["CS015215000021", "3090"],
            ["CS039814000011", "8031"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> customer_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">    WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id </span><span style="color:#569CD6">NOT</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'Z%\'</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span><span style="color:#E6E6E6"> customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    sum_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> customer_amount</span></span>\n<span class="line"><span style="color:#569CD6">WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">    sum_amount </span><span style="color:#D4D4D4">>=</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">        SELECT</span></span>\n<span class="line"><span style="color:#DCDCAA">            AVG</span><span style="color:#E6E6E6">(sum_amount)</span></span>\n<span class="line"><span style="color:#569CD6">        FROM</span><span style="color:#E6E6E6"> customer_amount</span></span>\n<span class="line"><span style="color:#E6E6E6">    )</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "36",
    title: "[結合]  内部結合1",
    description:
      "レシート明細データ（receipt）と店舗データ（store）を店舗コード(store_cd)で内部結合し、レシート明細データの全項目と店舗データの店舗名（store_name）を10件表示せよ。",
    solutions: [
      {
        sql: "SELECT\n    r.*,\n    s.store_name\nFROM receipt r\nJOIN store s\nON\n    r.store_cd = s.store_cd\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "sales_ymd",
            "sales_epoch",
            "store_cd",
            "receipt_no",
            "receipt_sub_no",
            "customer_id",
            "product_cd",
            "quantity",
            "amount",
            "store_name",
          ],
          rows: [
            [
              "20181103",
              "1541203200",
              "S14006",
              "112",
              "1",
              "CS006214000001",
              "P070305012",
              "1",
              "158",
              "葛が谷店",
            ],
            [
              "20181118",
              "1542499200",
              "S13008",
              "1132",
              "2",
              "CS008415000097",
              "P070701017",
              "1",
              "81",
              "成城店",
            ],
            [
              "20170712",
              "1499817600",
              "S14028",
              "1102",
              "1",
              "CS028414000014",
              "P060101005",
              "1",
              "170",
              "二ツ橋店",
            ],
            [
              "20190205",
              "1549324800",
              "S14042",
              "1132",
              "1",
              "ZZ000000000000",
              "P050301001",
              "1",
              "25",
              "新山下店",
            ],
            [
              "20180821",
              "1534809600",
              "S14025",
              "1102",
              "2",
              "CS025415000050",
              "P060102007",
              "1",
              "90",
              "大和店",
            ],
            [
              "20190605",
              "1559692800",
              "S13003",
              "1112",
              "1",
              "CS003515000195",
              "P050102002",
              "1",
              "138",
              "狛江店",
            ],
            [
              "20181205",
              "1543968000",
              "S14024",
              "1102",
              "2",
              "CS024514000042",
              "P080101005",
              "1",
              "30",
              "三田店",
            ],
            [
              "20190922",
              "1569110400",
              "S14040",
              "1102",
              "1",
              "CS040415000178",
              "P070501004",
              "1",
              "128",
              "長津田店",
            ],
            [
              "20170504",
              "1493856000",
              "S13020",
              "1112",
              "2",
              "ZZ000000000000",
              "P071302010",
              "1",
              "770",
              "十条仲原店",
            ],
            [
              "20191010",
              "1570665600",
              "S14027",
              "1102",
              "1",
              "CS027514000015",
              "P071101003",
              "1",
              "680",
              "南藤沢店",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    r.</span><span style="color:#D4D4D4">*</span><span style="color:#E6E6E6">,</span></span>\n<span class="line"><span style="color:#E6E6E6">    s.store_name</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt r</span></span>\n<span class="line"><span style="color:#569CD6">JOIN</span><span style="color:#E6E6E6"> store s</span></span>\n<span class="line"><span style="color:#569CD6">ON</span></span>\n<span class="line"><span style="color:#E6E6E6">    r.store_cd </span><span style="color:#D4D4D4">=</span><span style="color:#E6E6E6"> s.store_cd</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "37",
    title: "[結合]  内部結合2",
    description:
      "商品データ（product）とカテゴリデータ（category）をカテゴリ小区分コード(category_small_cd)で内部結合し、商品データの全項目とカテゴリデータのカテゴリ小区分名（category_small_name）を10件表示せよ。",
    solutions: [
      {
        sql: "SELECT\n    p.*,\n    c.category_small_name\nFROM product p\nJOIN category c\nON\n    p.category_small_cd = c.category_small_cd\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "product_cd",
            "category_major_cd",
            "category_medium_cd",
            "category_small_cd",
            "unit_price",
            "unit_cost",
            "category_small_name",
          ],
          rows: [
            ["P040101001", "04", "0401", "040101", "198", "149", "弁当類"],
            ["P040101002", "04", "0401", "040101", "218", "164", "弁当類"],
            ["P040101003", "04", "0401", "040101", "230", "173", "弁当類"],
            ["P040101004", "04", "0401", "040101", "248", "186", "弁当類"],
            ["P040101005", "04", "0401", "040101", "268", "201", "弁当類"],
            ["P040101006", "04", "0401", "040101", "298", "224", "弁当類"],
            ["P040101007", "04", "0401", "040101", "338", "254", "弁当類"],
            ["P040101008", "04", "0401", "040101", "420", "315", "弁当類"],
            ["P040101009", "04", "0401", "040101", "498", "374", "弁当類"],
            ["P040101010", "04", "0401", "040101", "580", "435", "弁当類"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    p.</span><span style="color:#D4D4D4">*</span><span style="color:#E6E6E6">,</span></span>\n<span class="line"><span style="color:#E6E6E6">    c.category_small_name</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> product p</span></span>\n<span class="line"><span style="color:#569CD6">JOIN</span><span style="color:#E6E6E6"> category c</span></span>\n<span class="line"><span style="color:#569CD6">ON</span></span>\n<span class="line"><span style="color:#E6E6E6">    p.category_small_cd </span><span style="color:#D4D4D4">=</span><span style="color:#E6E6E6"> c.category_small_cd</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "38",
    title: "[結合]  結合1",
    description:
      '顧客データ（customer）とレシート明細データ（receipt）から、顧客ごとの売上金額合計を求め、売上合計金額の降順、顧客IDの昇順で10件表示せよ。ただし、売上実績がない顧客については売上金額を0として表示させること。また、顧客は性別コード（gender_cd）が女性（1）であるものを対象とし、非会員（顧客IDが"Z"から始まるもの）は除外すること。',
    solutions: [
      {
        sql: "WITH customer_amount AS (\n    SELECT\n        customer_id,\n        SUM(amount) AS sum_amount\n    FROM receipt\n    GROUP BY\n        customer_id\n),\ncustomer_data AS (\n    SELECT\n        customer_id\n    FROM customer\n    WHERE\n        gender_cd = '1'\n        AND customer_id NOT LIKE 'Z%'\n)\nSELECT\n    c.customer_id,\n    COALESCE(a.sum_amount, 0) as sum_amount\nFROM customer_data c\nLEFT OUTER JOIN customer_amount a\nON\n    c.customer_id = a.customer_id\nORDER BY sum_amount DESC, customer_id\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "coalesce"],
          rows: [
            ["CS017415000097", "23086"],
            ["CS015415000185", "20153"],
            ["CS031414000051", "19202"],
            ["CS028415000007", "19127"],
            ["CS010214000010", "18585"],
            ["CS006515000023", "18372"],
            ["CS016415000141", "18372"],
            ["CS011414000106", "18338"],
            ["CS038415000104", "17847"],
            ["CS035414000024", "17615"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> customer_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">customer_data </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> customer</span></span>\n<span class="line"><span style="color:#569CD6">    WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">        gender_cd </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'1\'</span></span>\n<span class="line"><span style="color:#569CD6">        AND</span><span style="color:#E6E6E6"> customer_id </span><span style="color:#569CD6">NOT</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'Z%\'</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    c.customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">    COALESCE</span><span style="color:#E6E6E6">(a.sum_amount, </span><span style="color:#B5CEA8">0</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">as</span><span style="color:#E6E6E6"> sum_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> customer_data c</span></span>\n<span class="line"><span style="color:#569CD6">LEFT OUTER JOIN</span><span style="color:#E6E6E6"> customer_amount a</span></span>\n<span class="line"><span style="color:#569CD6">ON</span></span>\n<span class="line"><span style="color:#E6E6E6">    c.customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#E6E6E6"> a.customer_id</span></span>\n<span class="line"><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sum_amount </span><span style="color:#569CD6">DESC</span><span style="color:#E6E6E6">, customer_id</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "39",
    title: "[結合]  結合2",
    description:
      'レシート明細データ（receipt）から、売上日数の多い顧客の上位20件を抽出したデータと、売上金額合計の多い顧客の上位20件を抽出したデータをそれぞれ作成し、さらにその2つを完全外部結合せよ。ただし、非会員（顧客IDが"Z"から始まるもの）は除外すること。',
    solutions: [
      {
        sql: "WITH customer_data AS (\n    select\n        customer_id,\n        sales_ymd,\n        amount\n    FROM receipt\n    WHERE\n        customer_id NOT LIKE 'Z%'\n),\ncustomer_days AS (\n    select\n        customer_id,\n        COUNT(DISTINCT sales_ymd) come_days\n    FROM customer_data\n    GROUP BY\n        customer_id\n    ORDER BY\n        come_days DESC\n    LIMIT 20\n),\ncustomer_amount AS (\n    SELECT\n        customer_id,\n        SUM(amount) buy_amount\n    FROM customer_data\n    GROUP BY\n        customer_id\n    ORDER BY\n        buy_amount DESC\n    LIMIT 20\n)\nSELECT\n    COALESCE(d.customer_id, a.customer_id) customer_id,\n    d.come_days,\n    a.buy_amount\nFROM customer_days d\nFULL OUTER JOIN customer_amount a\nON\n    d.customer_id = a.customer_id\n;",
        expectedResult: {
          fields: ["customer_id", "come_days", "buy_amount"],
          rows: [
            ["CS040214000008", "23", "null"],
            ["CS015415000185", "22", "20153"],
            ["CS010214000010", "22", "18585"],
            ["CS028415000007", "21", "19127"],
            ["CS010214000002", "21", "null"],
            ["CS017415000097", "20", "23086"],
            ["CS016415000141", "20", "18372"],
            ["CS021514000045", "19", "null"],
            ["CS022515000226", "19", "null"],
            ["CS031414000051", "19", "19202"],
            ["CS039414000052", "19", "null"],
            ["CS014214000023", "19", "null"],
            ["CS021515000172", "19", "null"],
            ["CS031414000073", "18", "null"],
            ["CS007515000107", "18", "null"],
            ["CS014415000077", "18", "null"],
            ["CS021515000056", "18", "null"],
            ["CS032415000209", "18", "null"],
            ["CS021515000211", "18", "null"],
            ["CS022515000028", "18", "null"],
            ["CS011415000006", "null", "16094"],
            ["CS016415000101", "null", "16348"],
            ["CS030415000034", "null", "15468"],
            ["CS021515000089", "null", "17580"],
            ["CS034415000047", "null", "16083"],
            ["CS006515000023", "null", "18372"],
            ["CS038415000104", "null", "17847"],
            ["CS015515000034", "null", "15300"],
            ["CS032414000072", "null", "16563"],
            ["CS011414000106", "null", "18338"],
            ["CS001605000009", "null", "18925"],
            ["CS009414000059", "null", "15492"],
            ["CS035414000024", "null", "17615"],
            ["CS007514000094", "null", "15735"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> customer_data </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    select</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">        amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">    WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id </span><span style="color:#569CD6">NOT</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'Z%\'</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">customer_days </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    select</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        COUNT</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">DISTINCT</span><span style="color:#E6E6E6"> sales_ymd) come_days</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> customer_data</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#569CD6">    ORDER BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        come_days </span><span style="color:#569CD6">DESC</span></span>\n<span class="line"><span style="color:#569CD6">    LIMIT</span><span style="color:#B5CEA8"> 20</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">customer_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) buy_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> customer_data</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#569CD6">    ORDER BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        buy_amount </span><span style="color:#569CD6">DESC</span></span>\n<span class="line"><span style="color:#569CD6">    LIMIT</span><span style="color:#B5CEA8"> 20</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#DCDCAA">    COALESCE</span><span style="color:#E6E6E6">(d.customer_id, a.customer_id) customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    d.come_days,</span></span>\n<span class="line"><span style="color:#E6E6E6">    a.buy_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> customer_days d</span></span>\n<span class="line"><span style="color:#569CD6">FULL OUTER JOIN</span><span style="color:#E6E6E6"> customer_amount a</span></span>\n<span class="line"><span style="color:#569CD6">ON</span></span>\n<span class="line"><span style="color:#E6E6E6">    d.customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#E6E6E6"> a.customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "40",
    title: "[結合]  結合3",
    description:
      "全ての店舗と全ての商品を組み合わせたデータを作成したい。店舗データ（store）と商品データ（product）を直積し、件数を計算せよ。",
    solutions: [
      {
        sql: "SELECT\n    COUNT(1)\nFROM store\nCROSS JOIN product\n;",
        expectedResult: { fields: ["count"], rows: [["531590"]] },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#DCDCAA">    COUNT</span><span style="color:#E6E6E6">(</span><span style="color:#B5CEA8">1</span><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> store</span></span>\n<span class="line"><span style="color:#569CD6">CROSS JOIN</span><span style="color:#E6E6E6"> product</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "41",
    title: "[結合]  N件前の結合1",
    description:
      "レシート明細データ（receipt）の売上金額（amount）を日付（sales_ymd）ごとに集計し、前回売上があった日からの売上金額増減を計算せよ。そして結果を10件表示せよ。",
    solutions: [
      {
        sql: "WITH sales_amount_by_date AS (\n    SELECT\n        sales_ymd,\n        SUM(amount) AS amount\n    FROM receipt\n    GROUP BY\n        sales_ymd\n),\nsales_amount_by_date_with_lag as (\n    SELECT\n        sales_ymd,\n        LAG(sales_ymd, 1) OVER(ORDER BY sales_ymd) lag_ymd,\n        amount,\n        LAG(amount, 1) OVER(ORDER BY sales_ymd) AS lag_amount\n    FROM sales_amount_by_date\n)\nSELECT\n    sales_ymd,\n    amount,\n    lag_ymd,\n    lag_amount,\n    amount - lag_amount AS diff_amount\nFROM sales_amount_by_date_with_lag\nORDER BY\n    sales_ymd\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "sales_ymd",
            "amount",
            "lag_ymd",
            "lag_amount",
            "diff_amount",
          ],
          rows: [
            ["20170101", "33723", "null", "null", "null"],
            ["20170102", "24165", "20170101", "33723", "-9558"],
            ["20170103", "27503", "20170102", "24165", "3338"],
            ["20170104", "36165", "20170103", "27503", "8662"],
            ["20170105", "37830", "20170104", "36165", "1665"],
            ["20170106", "32387", "20170105", "37830", "-5443"],
            ["20170107", "23415", "20170106", "32387", "-8972"],
            ["20170108", "24737", "20170107", "23415", "1322"],
            ["20170109", "26718", "20170108", "24737", "1981"],
            ["20170110", "20143", "20170109", "26718", "-6575"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> sales_amount_by_date </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">sales_amount_by_date_with_lag </span><span style="color:#569CD6">as</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd,</span></span>\n<span class="line"><span style="color:#DCDCAA">        LAG</span><span style="color:#E6E6E6">(sales_ymd, </span><span style="color:#B5CEA8">1</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">OVER</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sales_ymd) lag_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">        amount,</span></span>\n<span class="line"><span style="color:#DCDCAA">        LAG</span><span style="color:#E6E6E6">(amount, </span><span style="color:#B5CEA8">1</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">OVER</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sales_ymd) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> lag_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> sales_amount_by_date</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount,</span></span>\n<span class="line"><span style="color:#E6E6E6">    lag_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    lag_amount,</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount </span><span style="color:#D4D4D4">-</span><span style="color:#E6E6E6"> lag_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> diff_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> sales_amount_by_date_with_lag</span></span>\n<span class="line"><span style="color:#569CD6">ORDER BY</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "42",
    title: "[結合]  N件前の結合2",
    description:
      "レシート明細データ（receipt）の売上金額（amount）を日付（sales_ymd）ごとに集計し、各日付のデータに対し、前回、前々回、3回前に売上があった日のデータを結合せよ。そして結果を10件表示せよ。",
    solutions: [
      {
        sql: "-- コード例1:縦持ちケース\nWITH sales_amount_by_date AS (\n    SELECT\n        sales_ymd,\n        SUM(amount) AS amount\n    FROM receipt\n    GROUP BY\n        sales_ymd\n),\nsales_amount_lag_date AS (\n    SELECT\n        sales_ymd,\n        LAG(sales_ymd, 3) OVER (ORDER BY sales_ymd) AS lag_date_3,\n        amount\n    FROM sales_amount_by_date\n)\nSELECT\n    a.sales_ymd,\n    a.amount,\n    b.sales_ymd AS lag_ymd,\n    b.amount AS lag_amount\nFROM sales_amount_lag_date a\nJOIN sales_amount_lag_date b\nON\n    (\n        a.lag_date_3 IS NULL\n        OR a.lag_date_3 <= b.sales_ymd\n    )\n    AND b.sales_ymd < a.sales_ymd\nORDER BY\n    sales_ymd,\n    lag_ymd\nLIMIT 10\n;",
        expectedResult: {
          fields: ["sales_ymd", "amount", "lag_ymd", "lag_amount"],
          rows: [
            ["20170102", "24165", "20170101", "33723"],
            ["20170103", "27503", "20170101", "33723"],
            ["20170103", "27503", "20170102", "24165"],
            ["20170104", "36165", "20170101", "33723"],
            ["20170104", "36165", "20170102", "24165"],
            ["20170104", "36165", "20170103", "27503"],
            ["20170105", "37830", "20170102", "24165"],
            ["20170105", "37830", "20170103", "27503"],
            ["20170105", "37830", "20170104", "36165"],
            ["20170106", "32387", "20170103", "27503"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- コード例1:縦持ちケース</span></span>\n<span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> sales_amount_by_date </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">sales_amount_lag_date </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd,</span></span>\n<span class="line"><span style="color:#DCDCAA">        LAG</span><span style="color:#E6E6E6">(sales_ymd, </span><span style="color:#B5CEA8">3</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">OVER</span><span style="color:#E6E6E6"> (</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sales_ymd) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> lag_date_3,</span></span>\n<span class="line"><span style="color:#E6E6E6">        amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> sales_amount_by_date</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    a.sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    a.amount,</span></span>\n<span class="line"><span style="color:#E6E6E6">    b.sales_ymd </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> lag_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    b.amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> lag_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> sales_amount_lag_date a</span></span>\n<span class="line"><span style="color:#569CD6">JOIN</span><span style="color:#E6E6E6"> sales_amount_lag_date b</span></span>\n<span class="line"><span style="color:#569CD6">ON</span></span>\n<span class="line"><span style="color:#E6E6E6">    (</span></span>\n<span class="line"><span style="color:#E6E6E6">        a.lag_date_3 </span><span style="color:#569CD6">IS</span><span style="color:#569CD6"> NULL</span></span>\n<span class="line"><span style="color:#569CD6">        OR</span><span style="color:#E6E6E6"> a.lag_date_3 </span><span style="color:#D4D4D4">&#x3C;=</span><span style="color:#E6E6E6"> b.sales_ymd</span></span>\n<span class="line"><span style="color:#E6E6E6">    )</span></span>\n<span class="line"><span style="color:#569CD6">    AND</span><span style="color:#E6E6E6"> b.sales_ymd </span><span style="color:#D4D4D4">&#x3C;</span><span style="color:#E6E6E6"> a.sales_ymd</span></span>\n<span class="line"><span style="color:#569CD6">ORDER BY</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    lag_ymd</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
      {
        sql: "-- コード例2:横持ちケース\nWITH sales_amount_by_date AS (\n    SELECT\n        sales_ymd,\n        SUM(amount) AS amount\n    FROM receipt\n    GROUP BY\n        sales_ymd\n),\nsales_amount_with_lag AS (\n    SELECT\n        sales_ymd,\n        amount, \n        LAG(sales_ymd, 1) OVER (ORDER BY sales_ymd) AS lag_ymd_1,\n        LAG(amount, 1) OVER (ORDER BY sales_ymd) AS lag_amount_1,\n        LAG(sales_ymd, 2) OVER (ORDER BY sales_ymd) AS lag_ymd_2,\n        LAG(amount, 2) OVER (ORDER BY sales_ymd) AS lag_amount_2,\n        LAG(sales_ymd, 3) OVER (ORDER BY sales_ymd) AS lag_ymd_3,\n        LAG(amount, 3) OVER (ORDER BY sales_ymd) AS lag_amount_3\n    FROM sales_amount_by_date\n)\nSELECT\n    sales_ymd,\n    amount, \n    lag_ymd_1,\n    lag_amount_1,\n    lag_ymd_2,\n    lag_amount_2,\n    lag_ymd_3,\n    lag_amount_3\nFROM sales_amount_with_lag\nWHERE\n    lag_ymd_3 IS NOT NULL\nORDER BY\n    sales_ymd\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "sales_ymd",
            "amount",
            "lag_ymd_1",
            "lag_amount_1",
            "lag_ymd_2",
            "lag_amount_2",
            "lag_ymd_3",
            "lag_amount_3",
          ],
          rows: [
            [
              "20170104",
              "36165",
              "20170103",
              "27503",
              "20170102",
              "24165",
              "20170101",
              "33723",
            ],
            [
              "20170105",
              "37830",
              "20170104",
              "36165",
              "20170103",
              "27503",
              "20170102",
              "24165",
            ],
            [
              "20170106",
              "32387",
              "20170105",
              "37830",
              "20170104",
              "36165",
              "20170103",
              "27503",
            ],
            [
              "20170107",
              "23415",
              "20170106",
              "32387",
              "20170105",
              "37830",
              "20170104",
              "36165",
            ],
            [
              "20170108",
              "24737",
              "20170107",
              "23415",
              "20170106",
              "32387",
              "20170105",
              "37830",
            ],
            [
              "20170109",
              "26718",
              "20170108",
              "24737",
              "20170107",
              "23415",
              "20170106",
              "32387",
            ],
            [
              "20170110",
              "20143",
              "20170109",
              "26718",
              "20170108",
              "24737",
              "20170107",
              "23415",
            ],
            [
              "20170111",
              "24287",
              "20170110",
              "20143",
              "20170109",
              "26718",
              "20170108",
              "24737",
            ],
            [
              "20170112",
              "23526",
              "20170111",
              "24287",
              "20170110",
              "20143",
              "20170109",
              "26718",
            ],
            [
              "20170113",
              "28004",
              "20170112",
              "23526",
              "20170111",
              "24287",
              "20170110",
              "20143",
            ],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- コード例2:横持ちケース</span></span>\n<span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> sales_amount_by_date </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">sales_amount_with_lag </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">        amount, </span></span>\n<span class="line"><span style="color:#DCDCAA">        LAG</span><span style="color:#E6E6E6">(sales_ymd, </span><span style="color:#B5CEA8">1</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">OVER</span><span style="color:#E6E6E6"> (</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sales_ymd) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> lag_ymd_1,</span></span>\n<span class="line"><span style="color:#DCDCAA">        LAG</span><span style="color:#E6E6E6">(amount, </span><span style="color:#B5CEA8">1</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">OVER</span><span style="color:#E6E6E6"> (</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sales_ymd) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> lag_amount_1,</span></span>\n<span class="line"><span style="color:#DCDCAA">        LAG</span><span style="color:#E6E6E6">(sales_ymd, </span><span style="color:#B5CEA8">2</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">OVER</span><span style="color:#E6E6E6"> (</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sales_ymd) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> lag_ymd_2,</span></span>\n<span class="line"><span style="color:#DCDCAA">        LAG</span><span style="color:#E6E6E6">(amount, </span><span style="color:#B5CEA8">2</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">OVER</span><span style="color:#E6E6E6"> (</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sales_ymd) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> lag_amount_2,</span></span>\n<span class="line"><span style="color:#DCDCAA">        LAG</span><span style="color:#E6E6E6">(sales_ymd, </span><span style="color:#B5CEA8">3</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">OVER</span><span style="color:#E6E6E6"> (</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sales_ymd) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> lag_ymd_3,</span></span>\n<span class="line"><span style="color:#DCDCAA">        LAG</span><span style="color:#E6E6E6">(amount, </span><span style="color:#B5CEA8">3</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">OVER</span><span style="color:#E6E6E6"> (</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sales_ymd) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> lag_amount_3</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> sales_amount_by_date</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount, </span></span>\n<span class="line"><span style="color:#E6E6E6">    lag_ymd_1,</span></span>\n<span class="line"><span style="color:#E6E6E6">    lag_amount_1,</span></span>\n<span class="line"><span style="color:#E6E6E6">    lag_ymd_2,</span></span>\n<span class="line"><span style="color:#E6E6E6">    lag_amount_2,</span></span>\n<span class="line"><span style="color:#E6E6E6">    lag_ymd_3,</span></span>\n<span class="line"><span style="color:#E6E6E6">    lag_amount_3</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> sales_amount_with_lag</span></span>\n<span class="line"><span style="color:#569CD6">WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">    lag_ymd_3 </span><span style="color:#569CD6">IS NOT NULL</span></span>\n<span class="line"><span style="color:#569CD6">ORDER BY</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "43",
    title: "[縦横変換]  縦から横",
    description:
      "レシート明細データ（receipt）と顧客データ（customer）を結合し、性別コード（gender_cd）と年代（ageから計算）ごとに売上金額（amount）を合計した売上サマリデータを作成せよ。性別コードは0が男性、1が女性、9が不明を表すものとする。ただし、項目構成は年代、女性の売上金額、男性の売上金額、性別不明の売上金額の4項目とすること（縦に年代、横に性別のクロス集計）。また、年代は10歳ごとの階級とすること。",
    solutions: [
      {
        sql: "DROP TABLE IF EXISTS sales_summary;\n\nCREATE TABLE sales_summary AS\n    WITH gender_era_amount AS (\n        SELECT\n            TRUNC(age / 10) * 10 AS era,\n            c.gender_cd,\n            SUM(r.amount) AS amount\n        FROM customer c\n        JOIN receipt r\n        ON\n            c.customer_id = r.customer_id\n        GROUP BY\n            era,\n            c.gender_cd\n    )\n    SELECT\n        era,\n        SUM(CASE WHEN gender_cd = '0' THEN amount END) AS male,\n        SUM(CASE WHEN gender_cd = '1' THEN amount END) AS female,\n        SUM(CASE WHEN gender_cd = '9' THEN amount END) AS unknown\n    FROM gender_era_amount\n    GROUP BY\n        era\n    ORDER BY\n        era\n;\n\nSELECT\n    *\nFROM sales_summary\n;",
        expectedResult: {
          fields: ["era", "male", "female", "unknown"],
          rows: [
            ["10", "1591", "149836", "4317"],
            ["20", "72940", "1363724", "44328"],
            ["30", "177322", "693047", "50441"],
            ["40", "19355", "9320791", "483512"],
            ["50", "54320", "6685192", "342923"],
            ["60", "272469", "987741", "71418"],
            ["70", "13435", "29764", "2427"],
            ["80", "46360", "262923", "5111"],
            ["90", "null", "6260", "null"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">DROP</span><span style="color:#569CD6"> TABLE</span><span style="color:#569CD6"> IF</span><span style="color:#569CD6"> EXISTS</span><span style="color:#E6E6E6"> sales_summary;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#569CD6">CREATE</span><span style="color:#569CD6"> TABLE</span><span style="color:#DCDCAA"> sales_summary</span><span style="color:#569CD6"> AS</span></span>\n<span class="line"><span style="color:#569CD6">    WITH</span><span style="color:#E6E6E6"> gender_era_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">        SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">            TRUNC(age </span><span style="color:#D4D4D4">/</span><span style="color:#B5CEA8"> 10</span><span style="color:#E6E6E6">) </span><span style="color:#D4D4D4">*</span><span style="color:#B5CEA8"> 10</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> era,</span></span>\n<span class="line"><span style="color:#E6E6E6">            c.gender_cd,</span></span>\n<span class="line"><span style="color:#DCDCAA">            SUM</span><span style="color:#E6E6E6">(r.amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount</span></span>\n<span class="line"><span style="color:#569CD6">        FROM</span><span style="color:#E6E6E6"> customer c</span></span>\n<span class="line"><span style="color:#569CD6">        JOIN</span><span style="color:#E6E6E6"> receipt r</span></span>\n<span class="line"><span style="color:#569CD6">        ON</span></span>\n<span class="line"><span style="color:#E6E6E6">            c.customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#E6E6E6"> r.customer_id</span></span>\n<span class="line"><span style="color:#569CD6">        GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">            era,</span></span>\n<span class="line"><span style="color:#E6E6E6">            c.gender_cd</span></span>\n<span class="line"><span style="color:#E6E6E6">    )</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        era,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">CASE</span><span style="color:#569CD6"> WHEN</span><span style="color:#E6E6E6"> gender_cd </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'0\'</span><span style="color:#569CD6"> THEN</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">END</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> male,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">CASE</span><span style="color:#569CD6"> WHEN</span><span style="color:#E6E6E6"> gender_cd </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'1\'</span><span style="color:#569CD6"> THEN</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">END</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> female,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">CASE</span><span style="color:#569CD6"> WHEN</span><span style="color:#E6E6E6"> gender_cd </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'9\'</span><span style="color:#569CD6"> THEN</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">END</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> unknown</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> gender_era_amount</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        era</span></span>\n<span class="line"><span style="color:#569CD6">    ORDER BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        era</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#D4D4D4">    *</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> sales_summary</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "44",
    title: "[縦横変換]  横から縦",
    description:
      '「[縦横変換]縦から横」で作成した売上サマリデータ（sales_summary）は性別の売上を横持ちさせたものであった。このデータから性別を縦持ちさせ、年代、性別コード、売上金額の3項目に変換せよ。ただし、性別コードは男性を"00"、女性を"01"、不明を"99"とする。\n\n[縦横変換]縦から横: レシート明細データ（receipt）と顧客データ（customer）を結合し、性別コード（gender_cd）と年代（ageから計算）ごとに売上金額（amount）を合計した売上サマリデータを作成せよ。性別コードは0が男性、1が女性、9が不明を表すものとする。ただし、項目構成は年代、女性の売上金額、男性の売上金額、性別不明の売上金額の4項目とすること（縦に年代、横に性別のクロス集計）。また、年代は10歳ごとの階級とすること。',
    solutions: [
      {
        sql: "DROP TABLE IF EXISTS sales_summary;\n\nCREATE TABLE sales_summary AS\n    WITH gender_era_amount AS (\n        SELECT\n            TRUNC(age / 10) * 10 AS era,\n            c.gender_cd,\n            SUM(r.amount) AS amount\n        FROM customer c\n        JOIN receipt r\n        ON\n            c.customer_id = r.customer_id\n        GROUP BY\n            era,\n            c.gender_cd\n    )\n    SELECT\n        era,\n        SUM(CASE WHEN gender_cd = '0' THEN amount END) AS male,\n        SUM(CASE WHEN gender_cd = '1' THEN amount END) AS female,\n        SUM(CASE WHEN gender_cd = '9' THEN amount END) AS unknown\n    FROM gender_era_amount\n    GROUP BY\n        era\n    ORDER BY\n        era\n;\n\nSELECT\n    *\nFROM sales_summary\n;\n\n-- SQL向きではないため、やや強引に記載する（カテゴリ数が多いときはとても長いSQLとなってしまう点に注意）\nSELECT era, '00' AS gender_cd , male AS amount FROM sales_summary\nUNION ALL\nSELECT era, '01' AS gender_cd, female AS amount FROM sales_summary\nUNION ALL\nSELECT era, '99' AS gender_cd, unknown AS amount FROM sales_summary\n;",
        expectedResult: {
          fields: ["era", "gender_cd", "amount"],
          rows: [
            ["10", "00", "1591"],
            ["20", "00", "72940"],
            ["30", "00", "177322"],
            ["40", "00", "19355"],
            ["50", "00", "54320"],
            ["60", "00", "272469"],
            ["70", "00", "13435"],
            ["80", "00", "46360"],
            ["90", "00", "null"],
            ["10", "01", "149836"],
            ["20", "01", "1363724"],
            ["30", "01", "693047"],
            ["40", "01", "9320791"],
            ["50", "01", "6685192"],
            ["60", "01", "987741"],
            ["70", "01", "29764"],
            ["80", "01", "262923"],
            ["90", "01", "6260"],
            ["10", "99", "4317"],
            ["20", "99", "44328"],
            ["30", "99", "50441"],
            ["40", "99", "483512"],
            ["50", "99", "342923"],
            ["60", "99", "71418"],
            ["70", "99", "2427"],
            ["80", "99", "5111"],
            ["90", "99", "null"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">DROP</span><span style="color:#569CD6"> TABLE</span><span style="color:#569CD6"> IF</span><span style="color:#569CD6"> EXISTS</span><span style="color:#E6E6E6"> sales_summary;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#569CD6">CREATE</span><span style="color:#569CD6"> TABLE</span><span style="color:#DCDCAA"> sales_summary</span><span style="color:#569CD6"> AS</span></span>\n<span class="line"><span style="color:#569CD6">    WITH</span><span style="color:#E6E6E6"> gender_era_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">        SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">            TRUNC(age </span><span style="color:#D4D4D4">/</span><span style="color:#B5CEA8"> 10</span><span style="color:#E6E6E6">) </span><span style="color:#D4D4D4">*</span><span style="color:#B5CEA8"> 10</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> era,</span></span>\n<span class="line"><span style="color:#E6E6E6">            c.gender_cd,</span></span>\n<span class="line"><span style="color:#DCDCAA">            SUM</span><span style="color:#E6E6E6">(r.amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount</span></span>\n<span class="line"><span style="color:#569CD6">        FROM</span><span style="color:#E6E6E6"> customer c</span></span>\n<span class="line"><span style="color:#569CD6">        JOIN</span><span style="color:#E6E6E6"> receipt r</span></span>\n<span class="line"><span style="color:#569CD6">        ON</span></span>\n<span class="line"><span style="color:#E6E6E6">            c.customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#E6E6E6"> r.customer_id</span></span>\n<span class="line"><span style="color:#569CD6">        GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">            era,</span></span>\n<span class="line"><span style="color:#E6E6E6">            c.gender_cd</span></span>\n<span class="line"><span style="color:#E6E6E6">    )</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        era,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">CASE</span><span style="color:#569CD6"> WHEN</span><span style="color:#E6E6E6"> gender_cd </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'0\'</span><span style="color:#569CD6"> THEN</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">END</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> male,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">CASE</span><span style="color:#569CD6"> WHEN</span><span style="color:#E6E6E6"> gender_cd </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'1\'</span><span style="color:#569CD6"> THEN</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">END</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> female,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">CASE</span><span style="color:#569CD6"> WHEN</span><span style="color:#E6E6E6"> gender_cd </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'9\'</span><span style="color:#569CD6"> THEN</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">END</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> unknown</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span><span style="color:#E6E6E6"> gender_era_amount</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        era</span></span>\n<span class="line"><span style="color:#569CD6">    ORDER BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        era</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#D4D4D4">    *</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> sales_summary</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#6A9955">-- SQL向きではないため、やや強引に記載する（カテゴリ数が多いときはとても長いSQLとなってしまう点に注意）</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#E6E6E6"> era, </span><span style="color:#CE9178">\'00\'</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> gender_cd , male </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> sales_summary</span></span>\n<span class="line"><span style="color:#569CD6">UNION ALL</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#E6E6E6"> era, </span><span style="color:#CE9178">\'01\'</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> gender_cd, female </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> sales_summary</span></span>\n<span class="line"><span style="color:#569CD6">UNION ALL</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#E6E6E6"> era, </span><span style="color:#CE9178">\'99\'</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> gender_cd, unknown </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> amount </span><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> sales_summary</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "45",
    title: "[データ変換]  日付型から文字列型",
    description:
      "顧客データ（customer）の生年月日（birth_day）は日付型でデータを保有している。これをYYYYMMDD形式の文字列に変換し、顧客ID（customer_id）とともに10件表示せよ。",
    solutions: [
      {
        sql: "SELECT\n    customer_id, \n    TO_CHAR(birth_day, 'YYYYMMDD') AS birth_day\nFROM customer \nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "birth_day"],
          rows: [
            ["CS021313000114", "19810429"],
            ["CS037613000071", "19520401"],
            ["CS031415000172", "19761004"],
            ["CS028811000001", "19330327"],
            ["CS001215000145", "19950329"],
            ["CS020401000016", "19740915"],
            ["CS015414000103", "19770809"],
            ["CS029403000008", "19730817"],
            ["CS015804000004", "19310502"],
            ["CS033513000180", "19620711"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id, </span></span>\n<span class="line"><span style="color:#E6E6E6">    TO_CHAR(birth_day, </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> birth_day</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> customer </span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "46",
    title: "[データ変換]  文字列型から日付型",
    description:
      "顧客データ（customer）の申し込み日（application_date）はYYYYMMDD形式の文字列型でデータを保有している。これを日付型に変換し、顧客ID（customer_id）とともに10件表示せよ。",
    solutions: [
      {
        sql: "SELECT\n    customer_id,\n    TO_DATE(application_date, 'YYYYMMDD') AS application_date\nFROM customer\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "application_date"],
          rows: [
            ["CS021313000114", "2015-09-05"],
            ["CS037613000071", "2015-04-14"],
            ["CS031415000172", "2015-05-29"],
            ["CS028811000001", "2016-01-15"],
            ["CS001215000145", "2017-06-05"],
            ["CS020401000016", "2015-02-25"],
            ["CS015414000103", "2015-07-22"],
            ["CS029403000008", "2015-05-15"],
            ["CS015804000004", "2015-06-07"],
            ["CS033513000180", "2015-07-28"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    TO_DATE(application_date, </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> application_date</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> customer</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "47",
    title: "[データ変換]  数値型から日付型",
    description:
      "レシート明細データ（receipt）の売上日（sales_ymd）はYYYYMMDD形式の数値型でデータを保有している。これを日付型に変換し、レシート番号(receipt_no)、レシートサブ番号（receipt_sub_no）とともに10件表示せよ。",
    solutions: [
      {
        sql: "SELECT  \n    receipt_no, \n    receipt_sub_no,\n    TO_DATE(CAST(sales_ymd AS VARCHAR), 'YYYYMMDD') AS sales_ymd\nFROM receipt \nLIMIT 10\n;",
        expectedResult: {
          fields: ["receipt_no", "receipt_sub_no", "sales_ymd"],
          rows: [
            ["112", "1", "2018-11-03"],
            ["1132", "2", "2018-11-18"],
            ["1102", "1", "2017-07-12"],
            ["1132", "1", "2019-02-05"],
            ["1102", "2", "2018-08-21"],
            ["1112", "1", "2019-06-05"],
            ["1102", "2", "2018-12-05"],
            ["1102", "1", "2019-09-22"],
            ["1112", "2", "2017-05-04"],
            ["1102", "1", "2019-10-10"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#E6E6E6">  </span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt_no, </span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt_sub_no,</span></span>\n<span class="line"><span style="color:#E6E6E6">    TO_DATE(</span><span style="color:#DCDCAA">CAST</span><span style="color:#E6E6E6">(sales_ymd </span><span style="color:#569CD6">AS</span><span style="color:#569CD6"> VARCHAR</span><span style="color:#E6E6E6">), </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sales_ymd</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt </span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "48",
    title: "[データ変換]  UNIX秒から日付型",
    description:
      "レシート明細データ（receipt）の売上エポック秒（sales_epoch）は数値型のUNIX秒でデータを保有している。これを日付型に変換し、レシート番号(receipt_no)、レシートサブ番号（receipt_sub_no）とともに10件表示せよ。",
    solutions: [
      {
        sql: "SELECT \n    receipt_no,\n    receipt_sub_no,\n    CAST(TO_TIMESTAMP(sales_epoch) AS DATE) AS sales_ymd\nFROM receipt \nLIMIT 10\n;",
        expectedResult: {
          fields: ["receipt_no", "receipt_sub_no", "sales_ymd"],
          rows: [
            ["112", "1", "2018-11-03"],
            ["1132", "2", "2018-11-18"],
            ["1102", "1", "2017-07-12"],
            ["1132", "1", "2019-02-05"],
            ["1102", "2", "2018-08-21"],
            ["1112", "1", "2019-06-05"],
            ["1102", "2", "2018-12-05"],
            ["1102", "1", "2019-09-22"],
            ["1112", "2", "2017-05-04"],
            ["1102", "1", "2019-10-10"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#E6E6E6"> </span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt_no,</span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt_sub_no,</span></span>\n<span class="line"><span style="color:#DCDCAA">    CAST</span><span style="color:#E6E6E6">(TO_TIMESTAMP(sales_epoch) </span><span style="color:#569CD6">AS</span><span style="color:#569CD6"> DATE</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sales_ymd</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt </span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "49",
    title: "[データ変換]  日付の取り出し(年)",
    description:
      "レシート明細データ（receipt）の売上エポック秒（sales_epoch）を日付型に変換し、「年」だけ取り出してレシート番号(receipt_no)、レシートサブ番号（receipt_sub_no）とともに10件表示せよ。",
    solutions: [
      {
        sql: "SELECT \n    receipt_no, \n    receipt_sub_no,\n    EXTRACT(YEAR FROM TO_TIMESTAMP(sales_epoch)) AS sales_year\nFROM receipt \nLIMIT 10\n;",
        expectedResult: {
          fields: ["receipt_no", "receipt_sub_no", "sales_year"],
          rows: [
            ["112", "1", "2018"],
            ["1132", "2", "2018"],
            ["1102", "1", "2017"],
            ["1132", "1", "2019"],
            ["1102", "2", "2018"],
            ["1112", "1", "2019"],
            ["1102", "2", "2018"],
            ["1102", "1", "2019"],
            ["1112", "2", "2017"],
            ["1102", "1", "2019"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#E6E6E6"> </span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt_no, </span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt_sub_no,</span></span>\n<span class="line"><span style="color:#E6E6E6">    EXTRACT(</span><span style="color:#569CD6">YEAR</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> TO_TIMESTAMP(sales_epoch)) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sales_year</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt </span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "50",
    title: "[データ変換]  日付の取り出し(月)",
    description:
      "レシート明細データ（receipt）の売上エポック秒（sales_epoch）を日付型に変換し、「月」だけ取り出してレシート番号(receipt_no)、レシートサブ番号（receipt_sub_no）とともに10件表示せよ。なお、「月」は0埋め2桁で取り出すこと。",
    solutions: [
      {
        sql: "SELECT \n    receipt_no, \n    receipt_sub_no,\n    TO_CHAR(\n        EXTRACT(MONTH FROM TO_TIMESTAMP(sales_epoch)), \n        'FM00'\n    ) AS sales_month\nFROM receipt\nLIMIT 10\n;",
        expectedResult: {
          fields: ["receipt_no", "receipt_sub_no", "sales_month"],
          rows: [
            ["112", "1", "11"],
            ["1132", "2", "11"],
            ["1102", "1", "07"],
            ["1132", "1", "02"],
            ["1102", "2", "08"],
            ["1112", "1", "06"],
            ["1102", "2", "12"],
            ["1102", "1", "09"],
            ["1112", "2", "05"],
            ["1102", "1", "10"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#E6E6E6"> </span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt_no, </span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt_sub_no,</span></span>\n<span class="line"><span style="color:#E6E6E6">    TO_CHAR(</span></span>\n<span class="line"><span style="color:#E6E6E6">        EXTRACT(</span><span style="color:#569CD6">MONTH</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> TO_TIMESTAMP(sales_epoch)), </span></span>\n<span class="line"><span style="color:#CE9178">        \'FM00\'</span></span>\n<span class="line"><span style="color:#E6E6E6">    ) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sales_month</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "51",
    title: "[データ変換]  日付の取り出し(日)",
    description:
      "レシート明細データ（receipt）の売上エポック秒(sales_epoch)を日付型に変換し、「日」だけ取り出してレシート番号(receipt_no)、レシートサブ番号（receipt_sub_no）とともに10件表示せよ。なお、「日」は0埋め2桁で取り出すこと。",
    solutions: [
      {
        sql: "SELECT \n    receipt_no, receipt_sub_no,\n    TO_CHAR(EXTRACT(DAY FROM TO_TIMESTAMP(sales_epoch)), 'FM00') AS sales_day\nFROM receipt LIMIT 10\n;",
        expectedResult: {
          fields: ["receipt_no", "receipt_sub_no", "sales_day"],
          rows: [
            ["112", "1", "03"],
            ["1132", "2", "18"],
            ["1102", "1", "12"],
            ["1132", "1", "05"],
            ["1102", "2", "21"],
            ["1112", "1", "05"],
            ["1102", "2", "05"],
            ["1102", "1", "22"],
            ["1112", "2", "04"],
            ["1102", "1", "10"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#E6E6E6"> </span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt_no, receipt_sub_no,</span></span>\n<span class="line"><span style="color:#E6E6E6">    TO_CHAR(EXTRACT(</span><span style="color:#569CD6">DAY</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> TO_TIMESTAMP(sales_epoch)), </span><span style="color:#CE9178">\'FM00\'</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sales_day</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt </span><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "52",
    title: "[データ変換]  数値データの二値化",
    description:
      'レシート明細データ（receipt）の売上金額（amount）を顧客ID（customer_id）ごとに合計の上、売上金額合計に対して2,000円以下を0、2,000円より大きい金額を1に二値化し、顧客ID、売上金額合計とともに10件表示せよ。ただし、顧客IDが"Z"から始まるのものは非会員を表すため、除外して計算すること。',
    solutions: [
      {
        sql: "SELECT\n    customer_id,\n    SUM(amount) AS sum_amount,\n    CASE\n        WHEN SUM(amount) > 2000 THEN 1\n        ELSE 0\n    END AS sales_flg\nFROM receipt\nWHERE customer_id NOT LIKE 'Z%'\nGROUP BY customer_id\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "sum_amount", "sales_flg"],
          rows: [
            ["CS001311000059", "2302", "1"],
            ["CS004614000122", "248", "0"],
            ["CS003512000043", "298", "0"],
            ["CS011615000061", "246", "0"],
            ["CS029212000033", "3604", "1"],
            ["CS007515000119", "7157", "1"],
            ["CS034515000123", "3699", "1"],
            ["CS004315000058", "490", "0"],
            ["CS026414000014", "6671", "1"],
            ["CS001615000099", "768", "0"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">    SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_amount,</span></span>\n<span class="line"><span style="color:#569CD6">    CASE</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#DCDCAA"> SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#D4D4D4">></span><span style="color:#B5CEA8"> 2000</span><span style="color:#569CD6"> THEN</span><span style="color:#B5CEA8"> 1</span></span>\n<span class="line"><span style="color:#569CD6">        ELSE</span><span style="color:#B5CEA8"> 0</span></span>\n<span class="line"><span style="color:#569CD6">    END</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> sales_flg</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> receipt</span></span>\n<span class="line"><span style="color:#569CD6">WHERE</span><span style="color:#E6E6E6"> customer_id </span><span style="color:#569CD6">NOT</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'Z%\'</span></span>\n<span class="line"><span style="color:#569CD6">GROUP BY</span><span style="color:#E6E6E6"> customer_id</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "53",
    title: "[データ変換]  文字データの二値化",
    description:
      "顧客データ（customer）の郵便番号（postal_cd）に対し、東京（先頭3桁が100〜209のもの）を1、それ以外のものを0に二値化せよ。さらにレシート明細データ（receipt）と結合し、全期間において売上実績のある顧客数を、作成した二値ごとにカウントせよ。",
    solutions: [
      {
        sql: "WITH cust AS (\n    SELECT\n        customer_id,\n        postal_cd,\n        CASE\n            WHEN CAST(SUBSTR(postal_cd, 1, 3) AS INTEGER) BETWEEN 100 AND 209 THEN 1\n            ELSE 0\n        END AS postal_flg\n    FROM\n        customer\n),\nrect AS(\n    SELECT DISTINCT\n        customer_id\n    FROM\n        receipt\n)\nSELECT \n    c.postal_flg, \n    COUNT(DISTINCT c.customer_id) AS customer_cnt\nFROM\n    cust c\nJOIN\n    rect r\nUSING (customer_id)\nGROUP BY\n    c.postal_flg\n;",
        expectedResult: {
          fields: ["postal_flg", "customer_cnt"],
          rows: [
            ["0", "3906"],
            ["1", "4400"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> cust </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">        postal_cd,</span></span>\n<span class="line"><span style="color:#569CD6">        CASE</span></span>\n<span class="line"><span style="color:#569CD6">            WHEN</span><span style="color:#DCDCAA"> CAST</span><span style="color:#E6E6E6">(SUBSTR(postal_cd, </span><span style="color:#B5CEA8">1</span><span style="color:#E6E6E6">, </span><span style="color:#B5CEA8">3</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#569CD6"> INTEGER</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">BETWEEN</span><span style="color:#B5CEA8"> 100</span><span style="color:#569CD6"> AND</span><span style="color:#B5CEA8"> 209</span><span style="color:#569CD6"> THEN</span><span style="color:#B5CEA8"> 1</span></span>\n<span class="line"><span style="color:#569CD6">            ELSE</span><span style="color:#B5CEA8"> 0</span></span>\n<span class="line"><span style="color:#569CD6">        END</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> postal_flg</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">rect </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6">(</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT DISTINCT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span><span style="color:#E6E6E6"> </span></span>\n<span class="line"><span style="color:#E6E6E6">    c.postal_flg, </span></span>\n<span class="line"><span style="color:#DCDCAA">    COUNT</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">DISTINCT</span><span style="color:#E6E6E6"> c.customer_id) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> customer_cnt</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    cust c</span></span>\n<span class="line"><span style="color:#569CD6">JOIN</span></span>\n<span class="line"><span style="color:#E6E6E6">    rect r</span></span>\n<span class="line"><span style="color:#569CD6">USING</span><span style="color:#E6E6E6"> (customer_id)</span></span>\n<span class="line"><span style="color:#569CD6">GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">    c.postal_flg</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "54",
    title: "[データ変換] カテゴライズ1",
    description:
      "顧客データ（customer）の住所（address）は、埼玉県、千葉県、東京都、神奈川県のいずれかとなっている。都道府県毎にコード値を作成し、顧客ID、住所とともに10件表示せよ。値は埼玉県を11、千葉県を12、東京都を13、神奈川県を14とすること。",
    solutions: [
      {
        sql: "-- SQL向きではないため、やや強引に記載する（カテゴリ数が多いときはとても長いSQLとなってしまう点に注意）\n-- コード例1（固定で切り出す）\nSELECT\n    customer_id,\n    address,\n    CASE SUBSTR(address,1, 3)\n        WHEN '埼玉県' THEN '11'\n        WHEN '千葉県' THEN '12'\n        WHEN '東京都' THEN '13'\n        WHEN '神奈川' THEN '14'\n    END AS prefecture_cd\nFROM\n    customer\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "address", "prefecture_cd"],
          rows: [
            ["CS021313000114", "神奈川県伊勢原市粟窪**********", "14"],
            ["CS037613000071", "東京都江東区南砂**********", "13"],
            ["CS031415000172", "東京都渋谷区代々木**********", "13"],
            ["CS028811000001", "神奈川県横浜市泉区和泉町**********", "14"],
            ["CS001215000145", "東京都大田区仲六郷**********", "13"],
            ["CS020401000016", "東京都板橋区若木**********", "13"],
            ["CS015414000103", "東京都江東区北砂**********", "13"],
            ["CS029403000008", "千葉県浦安市海楽**********", "12"],
            ["CS015804000004", "東京都江東区北砂**********", "13"],
            ["CS033513000180", "神奈川県横浜市旭区善部町**********", "14"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- SQL向きではないため、やや強引に記載する（カテゴリ数が多いときはとても長いSQLとなってしまう点に注意）</span></span>\n<span class="line"><span style="color:#6A9955">-- コード例1（固定で切り出す）</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#569CD6">    address</span><span style="color:#E6E6E6">,</span></span>\n<span class="line"><span style="color:#569CD6">    CASE</span><span style="color:#E6E6E6"> SUBSTR(</span><span style="color:#569CD6">address</span><span style="color:#E6E6E6">,</span><span style="color:#B5CEA8">1</span><span style="color:#E6E6E6">, </span><span style="color:#B5CEA8">3</span><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#CE9178"> \'埼玉県\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'11\'</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#CE9178"> \'千葉県\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'12\'</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#CE9178"> \'東京都\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'13\'</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#CE9178"> \'神奈川\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'14\'</span></span>\n<span class="line"><span style="color:#569CD6">    END</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> prefecture_cd</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
      {
        sql: "-- コード例2（正規表現を使う）\nSELECT\n    customer_id,\n    address,\n    CASE SUBSTRING(address, '^.*?[都道府県]')\n        WHEN '埼玉県' THEN '11'\n        WHEN '千葉県' THEN '12'\n        WHEN '東京都' THEN '13'\n        WHEN '神奈川県' THEN '14'\n    END AS prefecture_cd\nFROM\n    customer\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "address", "prefecture_cd"],
          rows: [
            ["CS021313000114", "神奈川県伊勢原市粟窪**********", "14"],
            ["CS037613000071", "東京都江東区南砂**********", "13"],
            ["CS031415000172", "東京都渋谷区代々木**********", "13"],
            ["CS028811000001", "神奈川県横浜市泉区和泉町**********", "14"],
            ["CS001215000145", "東京都大田区仲六郷**********", "13"],
            ["CS020401000016", "東京都板橋区若木**********", "13"],
            ["CS015414000103", "東京都江東区北砂**********", "13"],
            ["CS029403000008", "千葉県浦安市海楽**********", "12"],
            ["CS015804000004", "東京都江東区北砂**********", "13"],
            ["CS033513000180", "神奈川県横浜市旭区善部町**********", "14"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- コード例2（正規表現を使う）</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#569CD6">    address</span><span style="color:#E6E6E6">,</span></span>\n<span class="line"><span style="color:#569CD6">    CASE</span><span style="color:#DCDCAA"> SUBSTRING</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">address</span><span style="color:#E6E6E6">, </span><span style="color:#CE9178">\'^.*?[都道府県]\'</span><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#CE9178"> \'埼玉県\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'11\'</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#CE9178"> \'千葉県\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'12\'</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#CE9178"> \'東京都\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'13\'</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#CE9178"> \'神奈川県\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'14\'</span></span>\n<span class="line"><span style="color:#569CD6">    END</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> prefecture_cd</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
      {
        sql: "-- コード例3（LIKEを使う）\nSELECT\n    customer_id,\n    address,\n    CASE\n        WHEN address LIKE '埼玉県%' THEN '11'\n        WHEN address LIKE '千葉県%' THEN '12'\n        WHEN address LIKE '東京都%' THEN '13'\n        WHEN address LIKE '神奈川県%' THEN '14'\n    END AS prefecture_cd\nFROM\n    customer\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "address", "prefecture_cd"],
          rows: [
            ["CS021313000114", "神奈川県伊勢原市粟窪**********", "14"],
            ["CS037613000071", "東京都江東区南砂**********", "13"],
            ["CS031415000172", "東京都渋谷区代々木**********", "13"],
            ["CS028811000001", "神奈川県横浜市泉区和泉町**********", "14"],
            ["CS001215000145", "東京都大田区仲六郷**********", "13"],
            ["CS020401000016", "東京都板橋区若木**********", "13"],
            ["CS015414000103", "東京都江東区北砂**********", "13"],
            ["CS029403000008", "千葉県浦安市海楽**********", "12"],
            ["CS015804000004", "東京都江東区北砂**********", "13"],
            ["CS033513000180", "神奈川県横浜市旭区善部町**********", "14"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- コード例3（LIKEを使う）</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#569CD6">    address</span><span style="color:#E6E6E6">,</span></span>\n<span class="line"><span style="color:#569CD6">    CASE</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#569CD6"> address</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'埼玉県%\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'11\'</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#569CD6"> address</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'千葉県%\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'12\'</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#569CD6"> address</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'東京都%\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'13\'</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#569CD6"> address</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'神奈川県%\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'14\'</span></span>\n<span class="line"><span style="color:#569CD6">    END</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> prefecture_cd</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "55",
    title: "[データ変換] カテゴライズ2",
    description:
      "レシート明細（receipt）データの売上金額（amount）を顧客ID（customer_id）ごとに合計し、その合計金額の四分位点を求めよ。その上で、顧客ごとの売上金額合計に対して以下の基準でカテゴリ値を作成し、顧客ID、売上金額合計とともに10件表示せよ。カテゴリ値は順に1〜4とする。\n\n最小値以上第1四分位未満 ・・・ 1を付与\n第1四分位以上第2四分位未満 ・・・ 2を付与\n第2四分位以上第3四分位未満 ・・・ 3を付与\n第3四分位以上 ・・・ 4を付与",
    solutions: [
      {
        sql: "WITH sales_amount AS(\n    SELECT\n        customer_id,\n        SUM(amount) AS sum_amount\n    FROM\n        receipt\n    GROUP BY\n        customer_id\n),\nsales_pct AS (\n    SELECT\n        PERCENTILE_CONT(0.25) WITHIN GROUP(ORDER BY sum_amount) AS pct25,\n        PERCENTILE_CONT(0.50) WITHIN GROUP(ORDER BY sum_amount) AS pct50,\n        PERCENTILE_CONT(0.75) WITHIN GROUP(ORDER BY sum_amount) AS pct75\n    FROM\n        sales_amount\n)\nSELECT\n    a.customer_id,\n    a.sum_amount,\n    CASE\n        WHEN a.sum_amount < pct25 THEN 1\n        WHEN pct25 <= a.sum_amount AND a.sum_amount < pct50 THEN 2\n        WHEN pct50 <= a.sum_amount AND a.sum_amount < pct75 THEN 3\n        WHEN pct75 <= a.sum_amount THEN 4\n    END AS pct_group\nFROM sales_amount a\nCROSS JOIN sales_pct p\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "sum_amount", "pct_group"],
          rows: [
            ["CS001311000059", "2302", "3"],
            ["CS004614000122", "248", "1"],
            ["CS003512000043", "298", "1"],
            ["CS011615000061", "246", "1"],
            ["CS029212000033", "3604", "3"],
            ["CS007515000119", "7157", "4"],
            ["CS034515000123", "3699", "4"],
            ["CS004315000058", "490", "1"],
            ["CS026414000014", "6671", "4"],
            ["CS001615000099", "768", "2"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> sales_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6">(</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">sales_pct </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#DCDCAA">        PERCENTILE_CONT</span><span style="color:#E6E6E6">(</span><span style="color:#B5CEA8">0</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">25</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">WITHIN</span><span style="color:#DCDCAA"> GROUP</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sum_amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> pct25,</span></span>\n<span class="line"><span style="color:#DCDCAA">        PERCENTILE_CONT</span><span style="color:#E6E6E6">(</span><span style="color:#B5CEA8">0</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">50</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">WITHIN</span><span style="color:#DCDCAA"> GROUP</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sum_amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> pct50,</span></span>\n<span class="line"><span style="color:#DCDCAA">        PERCENTILE_CONT</span><span style="color:#E6E6E6">(</span><span style="color:#B5CEA8">0</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">75</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">WITHIN</span><span style="color:#DCDCAA"> GROUP</span><span style="color:#E6E6E6">(</span><span style="color:#569CD6">ORDER BY</span><span style="color:#E6E6E6"> sum_amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> pct75</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_amount</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    a.customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    a.sum_amount,</span></span>\n<span class="line"><span style="color:#569CD6">    CASE</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#E6E6E6"> a.sum_amount </span><span style="color:#D4D4D4">&#x3C;</span><span style="color:#E6E6E6"> pct25 </span><span style="color:#569CD6">THEN</span><span style="color:#B5CEA8"> 1</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#E6E6E6"> pct25 </span><span style="color:#D4D4D4">&#x3C;=</span><span style="color:#E6E6E6"> a.sum_amount </span><span style="color:#569CD6">AND</span><span style="color:#E6E6E6"> a.sum_amount </span><span style="color:#D4D4D4">&#x3C;</span><span style="color:#E6E6E6"> pct50 </span><span style="color:#569CD6">THEN</span><span style="color:#B5CEA8"> 2</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#E6E6E6"> pct50 </span><span style="color:#D4D4D4">&#x3C;=</span><span style="color:#E6E6E6"> a.sum_amount </span><span style="color:#569CD6">AND</span><span style="color:#E6E6E6"> a.sum_amount </span><span style="color:#D4D4D4">&#x3C;</span><span style="color:#E6E6E6"> pct75 </span><span style="color:#569CD6">THEN</span><span style="color:#B5CEA8"> 3</span></span>\n<span class="line"><span style="color:#569CD6">        WHEN</span><span style="color:#E6E6E6"> pct75 </span><span style="color:#D4D4D4">&#x3C;=</span><span style="color:#E6E6E6"> a.sum_amount </span><span style="color:#569CD6">THEN</span><span style="color:#B5CEA8"> 4</span></span>\n<span class="line"><span style="color:#569CD6">    END</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> pct_group</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> sales_amount a</span></span>\n<span class="line"><span style="color:#569CD6">CROSS JOIN</span><span style="color:#E6E6E6"> sales_pct p</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "56",
    title: "[データ変換] カテゴライズ3",
    description:
      "顧客データ（customer）の年齢（age）をもとに10歳刻みで年代を算出し、顧客ID（customer_id）、生年月日（birth_day）とともに10件表示せよ。ただし、60歳以上は全て60歳代とすること。年代を表すカテゴリ名は任意とする。",
    solutions: [
      {
        sql: "SELECT\n    customer_id,\n    birth_day,\n    -- 確認用の項目\n    -- age,\n    LEAST(CAST(TRUNC(age / 10) * 10 AS INTEGER), 60) AS era\nFROM\n    customer\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "birth_day", "era"],
          rows: [
            ["CS021313000114", "1981-04-29", "30"],
            ["CS037613000071", "1952-04-01", "60"],
            ["CS031415000172", "1976-10-04", "40"],
            ["CS028811000001", "1933-03-27", "60"],
            ["CS001215000145", "1995-03-29", "20"],
            ["CS020401000016", "1974-09-15", "40"],
            ["CS015414000103", "1977-08-09", "40"],
            ["CS029403000008", "1973-08-17", "40"],
            ["CS015804000004", "1931-05-02", "60"],
            ["CS033513000180", "1962-07-11", "50"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    birth_day,</span></span>\n<span class="line"><span style="color:#6A9955">    -- 確認用の項目</span></span>\n<span class="line"><span style="color:#6A9955">    -- age,</span></span>\n<span class="line"><span style="color:#DCDCAA">    LEAST</span><span style="color:#E6E6E6">(</span><span style="color:#DCDCAA">CAST</span><span style="color:#E6E6E6">(TRUNC(age </span><span style="color:#D4D4D4">/</span><span style="color:#B5CEA8"> 10</span><span style="color:#E6E6E6">) </span><span style="color:#D4D4D4">*</span><span style="color:#B5CEA8"> 10</span><span style="color:#569CD6"> AS</span><span style="color:#569CD6"> INTEGER</span><span style="color:#E6E6E6">), </span><span style="color:#B5CEA8">60</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> era</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "57",
    title: "[データ変換] カテゴライズ4",
    description:
      "「[データ変換]カテゴライズ3」の抽出結果と性別コード（gender_cd）により、新たに性別×年代の組み合わせを表すカテゴリデータを作成し、10件表示せよ。組み合わせを表すカテゴリの値はgender_cdと年代を組み合わせた文字列(例: 030)とする。\n\n[データ変換]カテゴライズ3: 顧客データ（customer）の年齢（age）をもとに10歳刻みで年代を算出し、顧客ID（customer_id）、生年月日（birth_day）とともに10件表示せよ。ただし、60歳以上は全て60歳代とすること。年代を表すカテゴリ名は任意とする。",
    solutions: [
      {
        sql: "-- 性別コード１桁と年代コード２桁を連結した性年代コードを生成する\nSELECT\n    customer_id,\n    birth_day,\n    gender_cd || TO_CHAR(LEAST(CAST(TRUNC(age / 10) * 10 AS INTEGER), 60), 'FM00') AS gender_era\nFROM\n    customer\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "birth_day", "gender_era"],
          rows: [
            ["CS021313000114", "1981-04-29", "130"],
            ["CS037613000071", "1952-04-01", "960"],
            ["CS031415000172", "1976-10-04", "140"],
            ["CS028811000001", "1933-03-27", "160"],
            ["CS001215000145", "1995-03-29", "120"],
            ["CS020401000016", "1974-09-15", "040"],
            ["CS015414000103", "1977-08-09", "140"],
            ["CS029403000008", "1973-08-17", "040"],
            ["CS015804000004", "1931-05-02", "060"],
            ["CS033513000180", "1962-07-11", "150"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- 性別コード１桁と年代コード２桁を連結した性年代コードを生成する</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    birth_day,</span></span>\n<span class="line"><span style="color:#E6E6E6">    gender_cd </span><span style="color:#D4D4D4">||</span><span style="color:#E6E6E6"> TO_CHAR(</span><span style="color:#DCDCAA">LEAST</span><span style="color:#E6E6E6">(</span><span style="color:#DCDCAA">CAST</span><span style="color:#E6E6E6">(TRUNC(age </span><span style="color:#D4D4D4">/</span><span style="color:#B5CEA8"> 10</span><span style="color:#E6E6E6">) </span><span style="color:#D4D4D4">*</span><span style="color:#B5CEA8"> 10</span><span style="color:#569CD6"> AS</span><span style="color:#569CD6"> INTEGER</span><span style="color:#E6E6E6">), </span><span style="color:#B5CEA8">60</span><span style="color:#E6E6E6">), </span><span style="color:#CE9178">\'FM00\'</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> gender_era</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "58",
    title: "[データ変換] ダミー変数化",
    description:
      "顧客データ（customer）の性別コード（gender_cd）をダミー変数化し、顧客ID（customer_id）とともに10件表示せよ。",
    solutions: [
      {
        sql: "-- カテゴリ数が多いときはとても長いSQLとなってしまう点に注意\n-- カテゴリを一つ減らしたい場合はCASE文をどれか一つ削ればOK\nSELECT\n    customer_id,\n    CASE WHEN gender_cd = '0' THEN '1' ELSE '0' END AS gender_cd_0,\n    CASE WHEN gender_cd = '1' THEN '1' ELSE '0' END AS gender_cd_1,\n    CASE WHEN gender_cd = '9' THEN '1' ELSE '0' END AS gender_cd_9\nFROM\n    customer\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "gender_cd_0", "gender_cd_1", "gender_cd_9"],
          rows: [
            ["CS021313000114", "0", "1", "0"],
            ["CS037613000071", "0", "0", "1"],
            ["CS031415000172", "0", "1", "0"],
            ["CS028811000001", "0", "1", "0"],
            ["CS001215000145", "0", "1", "0"],
            ["CS020401000016", "1", "0", "0"],
            ["CS015414000103", "0", "1", "0"],
            ["CS029403000008", "1", "0", "0"],
            ["CS015804000004", "1", "0", "0"],
            ["CS033513000180", "0", "1", "0"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- カテゴリ数が多いときはとても長いSQLとなってしまう点に注意</span></span>\n<span class="line"><span style="color:#6A9955">-- カテゴリを一つ減らしたい場合はCASE文をどれか一つ削ればOK</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#569CD6">    CASE</span><span style="color:#569CD6"> WHEN</span><span style="color:#E6E6E6"> gender_cd </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'0\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'1\'</span><span style="color:#569CD6"> ELSE</span><span style="color:#CE9178"> \'0\'</span><span style="color:#569CD6"> END</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> gender_cd_0,</span></span>\n<span class="line"><span style="color:#569CD6">    CASE</span><span style="color:#569CD6"> WHEN</span><span style="color:#E6E6E6"> gender_cd </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'1\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'1\'</span><span style="color:#569CD6"> ELSE</span><span style="color:#CE9178"> \'0\'</span><span style="color:#569CD6"> END</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> gender_cd_1,</span></span>\n<span class="line"><span style="color:#569CD6">    CASE</span><span style="color:#569CD6"> WHEN</span><span style="color:#E6E6E6"> gender_cd </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'9\'</span><span style="color:#569CD6"> THEN</span><span style="color:#CE9178"> \'1\'</span><span style="color:#569CD6"> ELSE</span><span style="color:#CE9178"> \'0\'</span><span style="color:#569CD6"> END</span><span style="color:#569CD6"> AS</span><span style="color:#E6E6E6"> gender_cd_9</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "59",
    title: "[数値化] 正規化(z-score)",
    description:
      'レシート明細データ（receipt）の売上金額（amount）を顧客ID（customer_id）ごとに合計し、売上金額合計を平均0、標準偏差1に標準化して顧客ID、売上金額合計とともに10件表示せよ。標準化に使用する標準偏差は、分散の平方根、もしくは不偏分散の平方根のどちらでも良いものとする。ただし、顧客IDが"Z"から始まるのものは非会員を表すため、除外して計算すること。',
    solutions: [
      {
        sql: "-- コード例1（STDDEV_POPで標準化）\nWITH sales_amount AS(\n    SELECT\n        customer_id,\n        SUM(amount) AS sum_amount\n    FROM\n        receipt\n    WHERE\n        customer_id NOT LIKE 'Z%'\n    GROUP BY\n        customer_id\n),\nstats_amount AS (\n    SELECT\n        AVG(sum_amount) AS avg_amount,\n        STDDEV_POP(sum_amount) AS stddev_amount\n    FROM\n        sales_amount\n)\nSELECT\n    customer_id,\n    sum_amount,\n    (sum_amount - avg_amount) / stddev_amount AS std_amount\nFROM sales_amount\nCROSS JOIN stats_amount\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "sum_amount", "std_amount"],
          rows: [
            ["CS001311000059", "2302", "-0.09032946448390523062"],
            ["CS004614000122", "248", "-0.84533488878695858131"],
            ["CS003512000043", "298", "-0.82695598361891930792"],
            ["CS011615000061", "246", "-0.84607004499368015224"],
            ["CS029212000033", "3604", "0.38825722609183744835"],
            ["CS007515000119", "7157", "1.6942622273327082"],
            ["CS034515000123", "3699", "0.42317714591111206778"],
            ["CS004315000058", "490", "-0.75638098777364849812"],
            ["CS026414000014", "6671", "1.5156192690993665"],
            ["CS001615000099", "768", "-0.65419427503935013810"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- コード例1（STDDEV_POPで標準化）</span></span>\n<span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> sales_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6">(</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#569CD6">    WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id </span><span style="color:#569CD6">NOT</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'Z%\'</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">stats_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#DCDCAA">        AVG</span><span style="color:#E6E6E6">(sum_amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> avg_amount,</span></span>\n<span class="line"><span style="color:#E6E6E6">        STDDEV_POP(sum_amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> stddev_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_amount</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    sum_amount,</span></span>\n<span class="line"><span style="color:#E6E6E6">    (sum_amount </span><span style="color:#D4D4D4">-</span><span style="color:#E6E6E6"> avg_amount) </span><span style="color:#D4D4D4">/</span><span style="color:#E6E6E6"> stddev_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> std_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> sales_amount</span></span>\n<span class="line"><span style="color:#569CD6">CROSS JOIN</span><span style="color:#E6E6E6"> stats_amount</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
      {
        sql: "-- コード例2（STDDEV_SAMPで標準化、コード例2と若干値が変わる）\nWITH sales_amount AS(\n    SELECT\n        customer_id,\n        SUM(amount) AS sum_amount\n    FROM\n        receipt\n    WHERE\n        customer_id NOT LIKE 'Z%'\n    GROUP BY\n        customer_id\n),\nstats_amount AS (\n    SELECT\n        AVG(sum_amount) AS avg_amount,\n        STDDEV_SAMP(sum_amount) AS stddev_amount\n    FROM\n        sales_amount\n)\nSELECT\n    customer_id,\n    sum_amount,\n    (sum_amount - avg_amount) / stddev_amount AS std_amount\nFROM sales_amount\nCROSS JOIN stats_amount\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "sum_amount", "std_amount"],
          rows: [
            ["CS001311000059", "2302", "-0.09032402671702291270"],
            ["CS004614000122", "248", "-0.84528400025253654164"],
            ["CS003512000043", "298", "-0.82690620148098070841"],
            ["CS011615000061", "246", "-0.84601911220339877497"],
            ["CS029212000033", "3604", "0.38823385329429098451"],
            ["CS007515000119", "7157", "1.6941602340010485"],
            ["CS034515000123", "3699", "0.42315167096024706764"],
            ["CS004315000058", "490", "-0.75633545419820630882"],
            ["CS026414000014", "6671", "1.5155280299415258"],
            ["CS001615000099", "768", "-0.65415489302835587608"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#6A9955">-- コード例2（STDDEV_SAMPで標準化、コード例2と若干値が変わる）</span></span>\n<span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> sales_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6">(</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#569CD6">    WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id </span><span style="color:#569CD6">NOT</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'Z%\'</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">stats_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#DCDCAA">        AVG</span><span style="color:#E6E6E6">(sum_amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> avg_amount,</span></span>\n<span class="line"><span style="color:#E6E6E6">        STDDEV_SAMP(sum_amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> stddev_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_amount</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    sum_amount,</span></span>\n<span class="line"><span style="color:#E6E6E6">    (sum_amount </span><span style="color:#D4D4D4">-</span><span style="color:#E6E6E6"> avg_amount) </span><span style="color:#D4D4D4">/</span><span style="color:#E6E6E6"> stddev_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> std_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> sales_amount</span></span>\n<span class="line"><span style="color:#569CD6">CROSS JOIN</span><span style="color:#E6E6E6"> stats_amount</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "60",
    title: "[数値化] 正規化(Min=0,Max=1)",
    description:
      'レシート明細データ（receipt）の売上金額（amount）を顧客ID（customer_id）ごとに合計し、売上金額合計を最小値0、最大値1に正規化して顧客ID、売上金額合計とともに10件表示せよ。ただし、顧客IDが"Z"から始まるのものは非会員を表すため、除外して計算すること。',
    solutions: [
      {
        sql: "WITH sales_amount AS(\n    SELECT\n        customer_id,\n        SUM(amount) AS sum_amount\n    FROM\n        receipt\n    WHERE\n        customer_id NOT LIKE 'Z%'\n    GROUP BY\n        customer_id\n),\nstats_amount AS (\n    SELECT\n        MAX(sum_amount) AS max_amount,\n        MIN(sum_amount) AS min_amount\n    FROM\n        sales_amount\n)\nSELECT\n    customer_id,\n    sum_amount,\n    1.0 * (sum_amount - min_amount)\n            / (max_amount -  min_amount) AS scale_amount\nFROM sales_amount\nCROSS JOIN stats_amount\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "sum_amount", "scale_amount"],
          rows: [
            ["CS001311000059", "2302", "0.09697601668404588113"],
            ["CS004614000122", "248", "0.00773375043448036149"],
            ["CS003512000043", "298", "0.00990615224191866528"],
            ["CS011615000061", "246", "0.00764685436218282934"],
            ["CS029212000033", "3604", "0.15354535974973931178"],
            ["CS007515000119", "7157", "0.30791623218630517901"],
            ["CS034515000123", "3699", "0.15767292318387208898"],
            ["CS004315000058", "490", "0.01824817518248175182"],
            ["CS026414000014", "6671", "0.28680048661800486618"],
            ["CS001615000099", "768", "0.03032672923183872089"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> sales_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6">(</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#569CD6">    WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id </span><span style="color:#569CD6">NOT</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'Z%\'</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">stats_amount </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#DCDCAA">        MAX</span><span style="color:#E6E6E6">(sum_amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> max_amount,</span></span>\n<span class="line"><span style="color:#DCDCAA">        MIN</span><span style="color:#E6E6E6">(sum_amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> min_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_amount</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    sum_amount,</span></span>\n<span class="line"><span style="color:#B5CEA8">    1</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">0</span><span style="color:#D4D4D4"> *</span><span style="color:#E6E6E6"> (sum_amount </span><span style="color:#D4D4D4">-</span><span style="color:#E6E6E6"> min_amount)</span></span>\n<span class="line"><span style="color:#D4D4D4">            /</span><span style="color:#E6E6E6"> (max_amount </span><span style="color:#D4D4D4">-</span><span style="color:#E6E6E6">  min_amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> scale_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> sales_amount</span></span>\n<span class="line"><span style="color:#569CD6">CROSS JOIN</span><span style="color:#E6E6E6"> stats_amount</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "61",
    title: "[数値化] 対数化1",
    description:
      'レシート明細データ（receipt）の売上金額（amount）を顧客ID（customer_id）ごとに合計し、売上金額合計に0.5を加えたうえで常用対数化（底10）して顧客ID、売上金額合計とともに10件表示せよ。ただし、顧客IDが"Z"から始まるのものは非会員を表すため、除外して計算すること。',
    solutions: [
      {
        sql: "SELECT\n    customer_id,\n    sum_amount,\n    LOG(sum_amount + 0.5) AS log_amount\nFROM\n(\n    SELECT\n        customer_id,\n        SUM(amount) AS sum_amount\n    FROM\n        receipt\n    WHERE\n        customer_id NOT LIKE 'Z%'\n    GROUP BY\n        customer_id\n) AS sum_amount_tbl\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "sum_amount", "log_amount"],
          rows: [
            ["CS001311000059", "2302", "3.3621996388688865"],
            ["CS004614000122", "248", "2.3953263930693509"],
            ["CS003512000043", "298", "2.4749443354653879"],
            ["CS011615000061", "246", "2.3918169236132488"],
            ["CS029212000033", "3604", "3.5568450298595813"],
            ["CS007515000119", "7157", "3.8547613566936362"],
            ["CS034515000123", "3699", "3.5681430316577019"],
            ["CS004315000058", "490", "2.6906390117159673"],
            ["CS026414000014", "6671", "3.8242234903608168"],
            ["CS001615000099", "768", "2.8856438718357639"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    sum_amount,</span></span>\n<span class="line"><span style="color:#DCDCAA">    LOG</span><span style="color:#E6E6E6">(sum_amount </span><span style="color:#D4D4D4">+</span><span style="color:#B5CEA8"> 0</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">5</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> log_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">(</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#569CD6">    WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id </span><span style="color:#569CD6">NOT</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'Z%\'</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_amount_tbl</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "62",
    title: "[数値化] 対数化2",
    description:
      'レシート明細データ（receipt）の売上金額（amount）を顧客ID（customer_id）ごとに合計し、売上金額合計に0.5を加えたうえで自然対数化（底e）して顧客ID、売上金額合計とともに10件表示せよ。ただし、顧客IDが"Z"から始まるのものは非会員を表すため、除外して計算すること。',
    solutions: [
      {
        sql: "SELECT\n    customer_id,\n    sum_amount,\n    LN(sum_amount + 0.5) AS log_amount\nFROM\n(\n    SELECT\n        customer_id,\n        SUM(amount) AS sum_amount\n    FROM\n        receipt\n    WHERE\n        customer_id NOT LIKE 'Z%'\n    GROUP BY\n        customer_id\n) AS sum_amount_tbl\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "sum_amount", "log_amount"],
          rows: [
            ["CS001311000059", "2302", "7.7417507681294619"],
            ["CS004614000122", "248", "5.5154428455366834"],
            ["CS003512000043", "298", "5.6987699328326568"],
            ["CS011615000061", "246", "5.5073619934827448"],
            ["CS029212000033", "3604", "8.1899383438446333"],
            ["CS007515000119", "7157", "8.8759160369722701"],
            ["CS034515000123", "3699", "8.2159529543656056"],
            ["CS004315000058", "490", "6.1954252790054178"],
            ["CS026414000014", "6671", "8.8056000011824754"],
            ["CS001615000099", "768", "6.6444405629786506"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    sum_amount,</span></span>\n<span class="line"><span style="color:#E6E6E6">    LN(sum_amount </span><span style="color:#D4D4D4">+</span><span style="color:#B5CEA8"> 0</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">5</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> log_amount</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">(</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_amount</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#569CD6">    WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id </span><span style="color:#569CD6">NOT</span><span style="color:#569CD6"> LIKE</span><span style="color:#CE9178"> \'Z%\'</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_amount_tbl</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "63",
    title: "[四則演算] 引き算",
    description:
      "商品データ（product）の単価（unit_price）と原価（unit_cost）から各商品の利益額を算出し、結果を10件表示せよ。",
    solutions: [
      {
        sql: "SELECT\n    product_cd, \n    unit_price, \n    unit_cost,\n    unit_price - unit_cost AS unit_profit\nFROM\n    product\nLIMIT 10\n;",
        expectedResult: {
          fields: ["product_cd", "unit_price", "unit_cost", "unit_profit"],
          rows: [
            ["P040101001", "198", "149", "49"],
            ["P040101002", "218", "164", "54"],
            ["P040101003", "230", "173", "57"],
            ["P040101004", "248", "186", "62"],
            ["P040101005", "268", "201", "67"],
            ["P040101006", "298", "224", "74"],
            ["P040101007", "338", "254", "84"],
            ["P040101008", "420", "315", "105"],
            ["P040101009", "498", "374", "124"],
            ["P040101010", "580", "435", "145"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    product_cd, </span></span>\n<span class="line"><span style="color:#E6E6E6">    unit_price, </span></span>\n<span class="line"><span style="color:#E6E6E6">    unit_cost,</span></span>\n<span class="line"><span style="color:#E6E6E6">    unit_price </span><span style="color:#D4D4D4">-</span><span style="color:#E6E6E6"> unit_cost </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> unit_profit</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    product</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "64",
    title: "[四則演算] 割り算",
    description:
      "商品データ（product）の単価（unit_price）と原価（unit_cost）から、各商品の利益率の全体平均を算出せよ。ただし、単価と原価には欠損が生じていることに注意せよ。",
    solutions: [
      {
        sql: "SELECT\n    AVG((unit_price * 1.0 - unit_cost) / unit_price) AS unit_profit_rate\nFROM\n    product\nLIMIT 10\n;",
        expectedResult: {
          fields: ["unit_profit_rate"],
          rows: [["0.24911389885177001279"]],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#DCDCAA">    AVG</span><span style="color:#E6E6E6">((unit_price </span><span style="color:#D4D4D4">*</span><span style="color:#B5CEA8"> 1</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">0</span><span style="color:#D4D4D4"> -</span><span style="color:#E6E6E6"> unit_cost) </span><span style="color:#D4D4D4">/</span><span style="color:#E6E6E6"> unit_price) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> unit_profit_rate</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    product</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "65",
    title: "[四則演算] 有効桁数",
    description:
      "商品データ（product）の各商品について、利益率が30%となる新たな単価を求めよ。ただし、1円未満は切り捨てること。そして結果を10件表示させ、利益率がおよそ30％付近であることを確認せよ。ただし、単価（unit_price）と原価（unit_cost）には欠損が生じていることに注意せよ。",
    solutions: [
      {
        sql: "WITH new_price_tbl AS (\n    SELECT\n        product_cd, \n        unit_price, \n        unit_cost,\n        TRUNC(unit_cost / 0.7) AS new_price\n    FROM\n        product\n) \nSELECT\n    *,\n    (new_price - unit_cost) / new_price AS new_profit_rate\nFROM\n    new_price_tbl\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "product_cd",
            "unit_price",
            "unit_cost",
            "new_price",
            "new_profit_rate",
          ],
          rows: [
            ["P040101001", "198", "149", "212", "0.29716981132075471698"],
            ["P040101002", "218", "164", "234", "0.29914529914529914530"],
            ["P040101003", "230", "173", "247", "0.29959514170040485830"],
            ["P040101004", "248", "186", "265", "0.29811320754716981132"],
            ["P040101005", "268", "201", "287", "0.29965156794425087108"],
            ["P040101006", "298", "224", "320", "0.30000000000000000000"],
            ["P040101007", "338", "254", "362", "0.29834254143646408840"],
            ["P040101008", "420", "315", "450", "0.30000000000000000000"],
            ["P040101009", "498", "374", "534", "0.29962546816479400749"],
            ["P040101010", "580", "435", "621", "0.29951690821256038647"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> new_price_tbl </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        product_cd, </span></span>\n<span class="line"><span style="color:#E6E6E6">        unit_price, </span></span>\n<span class="line"><span style="color:#E6E6E6">        unit_cost,</span></span>\n<span class="line"><span style="color:#E6E6E6">        TRUNC(unit_cost </span><span style="color:#D4D4D4">/</span><span style="color:#B5CEA8"> 0</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">7</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> new_price</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        product</span></span>\n<span class="line"><span style="color:#E6E6E6">) </span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#D4D4D4">    *</span><span style="color:#E6E6E6">,</span></span>\n<span class="line"><span style="color:#E6E6E6">    (new_price </span><span style="color:#D4D4D4">-</span><span style="color:#E6E6E6"> unit_cost) </span><span style="color:#D4D4D4">/</span><span style="color:#E6E6E6"> new_price </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> new_profit_rate</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    new_price_tbl</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "66",
    title: "[四則演算] 四捨五入",
    description:
      "商品データ（product）の各商品について、利益率が30%となる新たな単価を求めよ。今回は、1円未満を丸めること（四捨五入または偶数への丸めで良い）。そして結果を10件表示させ、利益率がおよそ30％付近であることを確認せよ。ただし、単価（unit_price）と原価（unit_cost）には欠損が生じていることに注意せよ。",
    solutions: [
      {
        sql: "WITH new_price_tbl AS (\n    SELECT\n        product_cd, \n        unit_price, \n        unit_cost,\n        ROUND(unit_cost / 0.7) AS new_price\n    FROM\n        product\n) \nSELECT\n    *,\n    (new_price - unit_cost) / new_price AS new_profit_rate\nFROM\n    new_price_tbl\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "product_cd",
            "unit_price",
            "unit_cost",
            "new_price",
            "new_profit_rate",
          ],
          rows: [
            ["P040101001", "198", "149", "213", "0.30046948356807511737"],
            ["P040101002", "218", "164", "234", "0.29914529914529914530"],
            ["P040101003", "230", "173", "247", "0.29959514170040485830"],
            ["P040101004", "248", "186", "266", "0.30075187969924812030"],
            ["P040101005", "268", "201", "287", "0.29965156794425087108"],
            ["P040101006", "298", "224", "320", "0.30000000000000000000"],
            ["P040101007", "338", "254", "363", "0.30027548209366391185"],
            ["P040101008", "420", "315", "450", "0.30000000000000000000"],
            ["P040101009", "498", "374", "534", "0.29962546816479400749"],
            ["P040101010", "580", "435", "621", "0.29951690821256038647"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> new_price_tbl </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        product_cd, </span></span>\n<span class="line"><span style="color:#E6E6E6">        unit_price, </span></span>\n<span class="line"><span style="color:#E6E6E6">        unit_cost,</span></span>\n<span class="line"><span style="color:#DCDCAA">        ROUND</span><span style="color:#E6E6E6">(unit_cost </span><span style="color:#D4D4D4">/</span><span style="color:#B5CEA8"> 0</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">7</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> new_price</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        product</span></span>\n<span class="line"><span style="color:#E6E6E6">) </span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#D4D4D4">    *</span><span style="color:#E6E6E6">,</span></span>\n<span class="line"><span style="color:#E6E6E6">    (new_price </span><span style="color:#D4D4D4">-</span><span style="color:#E6E6E6"> unit_cost) </span><span style="color:#D4D4D4">/</span><span style="color:#E6E6E6"> new_price </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> new_profit_rate</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    new_price_tbl</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "67",
    title: "[四則演算] 切り上げ",
    description:
      "商品データ（product）の各商品について、利益率が30%となる新たな単価を求めよ。今回は、1円未満を切り上げること。そして結果を10件表示させ、利益率がおよそ30％付近であることを確認せよ。ただし、単価（unit_price）と原価（unit_cost）には欠損が生じていることに注意せよ。",
    solutions: [
      {
        sql: "WITH new_price_tbl AS (\n    SELECT\n        product_cd, \n        unit_price, \n        unit_cost,\n        CEIL(unit_cost / 0.7) AS new_price\n    FROM\n        product\n) \nSELECT\n    *,\n    (new_price - unit_cost) / new_price AS new_profit_rate\nFROM\n    new_price_tbl\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "product_cd",
            "unit_price",
            "unit_cost",
            "new_price",
            "new_profit_rate",
          ],
          rows: [
            ["P040101001", "198", "149", "213", "0.30046948356807511737"],
            ["P040101002", "218", "164", "235", "0.30212765957446808511"],
            ["P040101003", "230", "173", "248", "0.30241935483870967742"],
            ["P040101004", "248", "186", "266", "0.30075187969924812030"],
            ["P040101005", "268", "201", "288", "0.30208333333333333333"],
            ["P040101006", "298", "224", "320", "0.30000000000000000000"],
            ["P040101007", "338", "254", "363", "0.30027548209366391185"],
            ["P040101008", "420", "315", "450", "0.30000000000000000000"],
            ["P040101009", "498", "374", "535", "0.30093457943925233645"],
            ["P040101010", "580", "435", "622", "0.30064308681672025723"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> new_price_tbl </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        product_cd, </span></span>\n<span class="line"><span style="color:#E6E6E6">        unit_price, </span></span>\n<span class="line"><span style="color:#E6E6E6">        unit_cost,</span></span>\n<span class="line"><span style="color:#E6E6E6">        CEIL(unit_cost </span><span style="color:#D4D4D4">/</span><span style="color:#B5CEA8"> 0</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">7</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> new_price</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        product</span></span>\n<span class="line"><span style="color:#E6E6E6">) </span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#D4D4D4">    *</span><span style="color:#E6E6E6">,</span></span>\n<span class="line"><span style="color:#E6E6E6">    (new_price </span><span style="color:#D4D4D4">-</span><span style="color:#E6E6E6"> unit_cost) </span><span style="color:#D4D4D4">/</span><span style="color:#E6E6E6"> new_price </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> new_profit_rate</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    new_price_tbl</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "68",
    title: "[四則演算] 切り捨て",
    description:
      "商品データ（product）の各商品について、消費税率10％の税込み金額を求めよ。1円未満の端数は切り捨てとし、結果を10件表示せよ。ただし、単価（unit_price）には欠損が生じていることに注意せよ。",
    solutions: [
      {
        sql: "SELECT\n    product_cd,\n    unit_price,\n    TRUNC(unit_price * 1.1) AS tax_price\nFROM\n    product\nLIMIT 10\n;",
        expectedResult: {
          fields: ["product_cd", "unit_price", "tax_price"],
          rows: [
            ["P040101001", "198", "217"],
            ["P040101002", "218", "239"],
            ["P040101003", "230", "253"],
            ["P040101004", "248", "272"],
            ["P040101005", "268", "294"],
            ["P040101006", "298", "327"],
            ["P040101007", "338", "371"],
            ["P040101008", "420", "462"],
            ["P040101009", "498", "547"],
            ["P040101010", "580", "638"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    product_cd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    unit_price,</span></span>\n<span class="line"><span style="color:#E6E6E6">    TRUNC(unit_price </span><span style="color:#D4D4D4">*</span><span style="color:#B5CEA8"> 1</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">1</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> tax_price</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    product</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "69",
    title: "[四則演算] 割合",
    description:
      'レシート明細データ（receipt）と商品データ（product）を商品コード(product_cd)で結合し、顧客毎に全商品の売上金額合計と、カテゴリ大区分コード（category_major_cd）が"07"（瓶詰缶詰）の売上金額合計を計算の上、両者の比率を求めよ。抽出対象はカテゴリ大区分コード"07"（瓶詰缶詰）の売上実績がある顧客のみとし、結果を10件表示せよ。',
    solutions: [
      {
        sql: "WITH amount_all AS(\n    SELECT\n        customer_id,\n        SUM(amount) AS sum_all\n    FROM\n        receipt\n    GROUP BY\n        customer_id\n),\namount_07 AS (\n    SELECT\n        r.customer_id,\n        SUM(r.amount) AS sum_07\n    FROM\n        receipt r\n    JOIN\n        product p\n    ON\n        r.product_cd = p.product_cd\n    WHERE\n        p.category_major_cd = '07'\n    GROUP BY\n        customer_id\n)\nSELECT\n    amount_all.customer_id,\n    sum_all,\n    sum_07,\n    sum_07 * 1.0 / sum_all AS sales_rate\nFROM\n    amount_all\nJOIN\n    amount_07\nON\n    amount_all.customer_id = amount_07.customer_id\nLIMIT 10\n;",
        expectedResult: {
          fields: ["customer_id", "sum_all", "sum_07", "sales_rate"],
          rows: [
            ["CS001311000059", "2302", "102", "0.04430929626411815812"],
            ["CS011615000061", "246", "98", "0.39837398373983739837"],
            ["CS029212000033", "3604", "3604", "1.00000000000000000000"],
            ["CS007515000119", "7157", "2832", "0.39569652088864049183"],
            ["CS034515000123", "3699", "1202", "0.32495268991619356583"],
            ["CS026414000014", "6671", "3142", "0.47099385399490331285"],
            ["CS001615000099", "768", "318", "0.41406250000000000000"],
            ["CS010515000082", "1482", "553", "0.37314439946018893387"],
            ["CS019315000045", "813", "380", "0.46740467404674046740"],
            ["CS008513000099", "1322", "210", "0.15885022692889561271"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> amount_all </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6">(</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_all</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">amount_07 </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        r.customer_id,</span></span>\n<span class="line"><span style="color:#DCDCAA">        SUM</span><span style="color:#E6E6E6">(r.amount) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sum_07</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt r</span></span>\n<span class="line"><span style="color:#569CD6">    JOIN</span></span>\n<span class="line"><span style="color:#E6E6E6">        product p</span></span>\n<span class="line"><span style="color:#569CD6">    ON</span></span>\n<span class="line"><span style="color:#E6E6E6">        r.product_cd </span><span style="color:#D4D4D4">=</span><span style="color:#E6E6E6"> p.product_cd</span></span>\n<span class="line"><span style="color:#569CD6">    WHERE</span></span>\n<span class="line"><span style="color:#E6E6E6">        p.category_major_cd </span><span style="color:#D4D4D4">=</span><span style="color:#CE9178"> \'07\'</span></span>\n<span class="line"><span style="color:#569CD6">    GROUP BY</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount_all.customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    sum_all,</span></span>\n<span class="line"><span style="color:#E6E6E6">    sum_07,</span></span>\n<span class="line"><span style="color:#E6E6E6">    sum_07 </span><span style="color:#D4D4D4">*</span><span style="color:#B5CEA8"> 1</span><span style="color:#E6E6E6">.</span><span style="color:#B5CEA8">0</span><span style="color:#D4D4D4"> /</span><span style="color:#E6E6E6"> sum_all </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sales_rate</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount_all</span></span>\n<span class="line"><span style="color:#569CD6">JOIN</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount_07</span></span>\n<span class="line"><span style="color:#569CD6">ON</span></span>\n<span class="line"><span style="color:#E6E6E6">    amount_all.customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#E6E6E6"> amount_07.customer_id</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "70",
    title: "[四則演算] 経過日数の計算1",
    description:
      "レシート明細データ（receipt）の売上日（sales_ymd）に対し、顧客データ（customer）の会員申込日（application_date）からの経過日数を計算し、顧客ID（customer_id）、売上日、会員申込日とともに経過日数の降順、会員申込日の降順で10件表示せよ（sales_ymdは数値、application_dateは文字列でデータを保持している点に注意）。",
    solutions: [
      {
        sql: "WITH receipt_distinct AS (\n    SELECT distinct\n        customer_id,\n        sales_ymd\n    FROM\n        receipt\n)\nSELECT\n    c.customer_id,\n    r.sales_ymd,\n    c.application_date,\n    EXTRACT(DAY FROM (TO_TIMESTAMP(CAST(r.sales_ymd AS VARCHAR), 'YYYYMMDD') \n                - TO_TIMESTAMP(c.application_date, 'YYYYMMDD'))) AS elapsed_days\nFROM\n    receipt_distinct r\nJOIN\n    customer c\nON\n    r.customer_id = c.customer_id\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "customer_id",
            "sales_ymd",
            "application_date",
            "elapsed_days",
          ],
          rows: [
            ["CS025314000050", "20190917", "20131214", "2103"],
            ["CS001515000074", "20190805", "20140308", "1976"],
            ["CS016211000011", "20190807", "20140314", "1972"],
            ["CS016211000011", "20190728", "20140314", "1962"],
            ["CS015513000039", "20190906", "20140510", "1945"],
            ["CS040515000174", "20190901", "20140521", "1929"],
            ["CS019515000038", "20190807", "20140620", "1874"],
            ["CS040515000174", "20190708", "20140521", "1874"],
            ["CS040515000174", "20190630", "20140521", "1866"],
            ["CS012513000197", "20190927", "20140915", "1838"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> receipt_distinct </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT distinct</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    c.customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    r.sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    c.application_date,</span></span>\n<span class="line"><span style="color:#E6E6E6">    EXTRACT(</span><span style="color:#569CD6">DAY</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> (TO_TIMESTAMP(</span><span style="color:#DCDCAA">CAST</span><span style="color:#E6E6E6">(r.sales_ymd </span><span style="color:#569CD6">AS</span><span style="color:#569CD6"> VARCHAR</span><span style="color:#E6E6E6">), </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">) </span></span>\n<span class="line"><span style="color:#D4D4D4">                -</span><span style="color:#E6E6E6"> TO_TIMESTAMP(c.application_date, </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">))) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> elapsed_days</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt_distinct r</span></span>\n<span class="line"><span style="color:#569CD6">JOIN</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer c</span></span>\n<span class="line"><span style="color:#569CD6">ON</span></span>\n<span class="line"><span style="color:#E6E6E6">    r.customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#E6E6E6"> c.customer_id</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "71",
    title: "[四則演算] 経過日数の計算2",
    description:
      "レシート明細データ（receipt）の売上日（sales_ymd）に対し、顧客データ（customer）の会員申込日（application_date）からの経過月数を計算し、顧客ID（customer_id）、売上日、会員申込日とともに経過月数の降順、売上日の降順で10件表示せよ（sales_ymdは数値、application_dateは文字列でデータを保持している点に注意）。1ヶ月未満は切り捨てること。",
    solutions: [
      {
        sql: "WITH receipt_distinct AS (\n    SELECT DISTINCT\n        customer_id,\n        sales_ymd\n    FROM\n        receipt\n),\ntime_age_tbl AS(\n    SELECT\n        c.customer_id,\n        r.sales_ymd,\n        c.application_date,\n        AGE(TO_TIMESTAMP(CAST(r.sales_ymd AS VARCHAR), 'YYYYMMDD'),\n                    TO_TIMESTAMP(c.application_date, 'YYYYMMDD')) AS time_age\n    FROM\n        receipt_distinct r\n    JOIN\n        customer c\n    ON\n        r.customer_id = c.customer_id\n)\nSELECT\n    customer_id, \n    sales_ymd, \n    application_date,\n    EXTRACT(YEAR FROM time_age) * 12 \n        + EXTRACT(MONTH FROM time_age) AS elapsed_months\nFROM\n    time_age_tbl\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "customer_id",
            "sales_ymd",
            "application_date",
            "elapsed_months",
          ],
          rows: [
            ["CS025314000050", "20190917", "20131214", "69"],
            ["CS016211000011", "20190807", "20140314", "64"],
            ["CS001515000074", "20190805", "20140308", "64"],
            ["CS016211000011", "20190728", "20140314", "64"],
            ["CS015513000039", "20190906", "20140510", "63"],
            ["CS040515000174", "20190901", "20140521", "63"],
            ["CS019515000038", "20190807", "20140620", "61"],
            ["CS040515000174", "20190708", "20140521", "61"],
            ["CS040515000174", "20190630", "20140521", "61"],
            ["CS010415000009", "20191005", "20141003", "60"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> receipt_distinct </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT DISTINCT</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">time_age_tbl </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6">(</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        c.customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">        r.sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">        c.application_date,</span></span>\n<span class="line"><span style="color:#E6E6E6">        AGE(TO_TIMESTAMP(</span><span style="color:#DCDCAA">CAST</span><span style="color:#E6E6E6">(r.sales_ymd </span><span style="color:#569CD6">AS</span><span style="color:#569CD6"> VARCHAR</span><span style="color:#E6E6E6">), </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">),</span></span>\n<span class="line"><span style="color:#E6E6E6">                    TO_TIMESTAMP(c.application_date, </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">)) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> time_age</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt_distinct r</span></span>\n<span class="line"><span style="color:#569CD6">    JOIN</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer c</span></span>\n<span class="line"><span style="color:#569CD6">    ON</span></span>\n<span class="line"><span style="color:#E6E6E6">        r.customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#E6E6E6"> c.customer_id</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer_id, </span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd, </span></span>\n<span class="line"><span style="color:#E6E6E6">    application_date,</span></span>\n<span class="line"><span style="color:#E6E6E6">    EXTRACT(</span><span style="color:#569CD6">YEAR</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> time_age) </span><span style="color:#D4D4D4">*</span><span style="color:#B5CEA8"> 12</span><span style="color:#E6E6E6"> </span></span>\n<span class="line"><span style="color:#D4D4D4">        +</span><span style="color:#E6E6E6"> EXTRACT(</span><span style="color:#569CD6">MONTH</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> time_age) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> elapsed_months</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    time_age_tbl</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "72",
    title: "[四則演算] 経過年数",
    description:
      "レシート明細データ（receipt）の売上日（sales_ymd）に対し、顧客データ（customer）の会員申込日（application_date）からの経過年数を計算し、顧客ID（customer_id）、売上日、会員申込日とともに経過年数の降順、販売日の降順、会員申込日の降順で10件表示せよ（sales_ymdは数値、application_dateは文字列でデータを保持している点に注意）。1年未満は切り捨てること。",
    solutions: [
      {
        sql: "WITH receipt_distinct AS (\n    SELECT distinct\n        customer_id,\n        sales_ymd\n    FROM\n        receipt\n)\nSELECT\n    c.customer_id,\n    r.sales_ymd,\n    c.application_date,\n    EXTRACT(YEAR FROM AGE(\n        TO_TIMESTAMP(CAST(r.sales_ymd AS VARCHAR), 'YYYYMMDD'), \n        TO_TIMESTAMP(c.application_date, 'YYYYMMDD'))) AS elapsed_years\nFROM\n    receipt_distinct r\nJOIN\n    customer c\nON\n    r.customer_id = c.customer_id\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "customer_id",
            "sales_ymd",
            "application_date",
            "elapsed_years",
          ],
          rows: [
            ["CS010415000009", "20191005", "20141003", "5"],
            ["CS012513000197", "20190927", "20140915", "5"],
            ["CS025314000050", "20190917", "20131214", "5"],
            ["CS015513000039", "20190906", "20140510", "5"],
            ["CS040515000174", "20190901", "20140521", "5"],
            ["CS019515000038", "20190807", "20140620", "5"],
            ["CS016211000011", "20190807", "20140314", "5"],
            ["CS001515000074", "20190805", "20140308", "5"],
            ["CS016211000011", "20190728", "20140314", "5"],
            ["CS040515000174", "20190708", "20140521", "5"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> receipt_distinct </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT distinct</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    c.customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    r.sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    c.application_date,</span></span>\n<span class="line"><span style="color:#E6E6E6">    EXTRACT(</span><span style="color:#569CD6">YEAR</span><span style="color:#569CD6"> FROM</span><span style="color:#E6E6E6"> AGE(</span></span>\n<span class="line"><span style="color:#E6E6E6">        TO_TIMESTAMP(</span><span style="color:#DCDCAA">CAST</span><span style="color:#E6E6E6">(r.sales_ymd </span><span style="color:#569CD6">AS</span><span style="color:#569CD6"> VARCHAR</span><span style="color:#E6E6E6">), </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">), </span></span>\n<span class="line"><span style="color:#E6E6E6">        TO_TIMESTAMP(c.application_date, </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">))) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> elapsed_years</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt_distinct r</span></span>\n<span class="line"><span style="color:#569CD6">JOIN</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer c</span></span>\n<span class="line"><span style="color:#569CD6">ON</span></span>\n<span class="line"><span style="color:#E6E6E6">    r.customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#E6E6E6"> c.customer_id</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "73",
    title: "[四則演算] 経過時間",
    description:
      "レシート明細データ（receipt）の売上日（sales_ymd）に対し、顧客データ（customer）の会員申込日（application_date）からのエポック秒による経過時間を計算し、顧客ID（customer_id）、売上日、会員申込日とともに経過時間の降順、sales_ymdの降順で10件表示せよ（なお、sales_ymdは数値、application_dateは文字列でデータを保持している点に注意）。なお、時間情報は保有していないため各日付は0時0分0秒を表すものとする。",
    solutions: [
      {
        sql: "WITH receipt_distinct AS (\n    SELECT distinct\n        customer_id,\n        sales_ymd\n    FROM\n        receipt\n)\nSELECT\n    c.customer_id,\n    r.sales_ymd,\n    c.application_date,\n    EXTRACT(EPOCH FROM \n            TO_TIMESTAMP(CAST(r.sales_ymd AS VARCHAR), 'YYYYMMDD') - \n            TO_TIMESTAMP(c.application_date, 'YYYYMMDD')\n    ) AS elapsed_epoch\nFROM\n    receipt_distinct r\nJOIN\n    customer c\nON\n    r.customer_id = c.customer_id\nLIMIT 10\n;",
        expectedResult: {
          fields: [
            "customer_id",
            "sales_ymd",
            "application_date",
            "elapsed_epoch",
          ],
          rows: [
            ["CS025314000050", "20190917", "20131214", "181699200.000000"],
            ["CS001515000074", "20190805", "20140308", "170726400.000000"],
            ["CS016211000011", "20190807", "20140314", "170380800.000000"],
            ["CS016211000011", "20190728", "20140314", "169516800.000000"],
            ["CS015513000039", "20190906", "20140510", "168048000.000000"],
            ["CS040515000174", "20190901", "20140521", "166665600.000000"],
            ["CS019515000038", "20190807", "20140620", "161913600.000000"],
            ["CS040515000174", "20190708", "20140521", "161913600.000000"],
            ["CS040515000174", "20190630", "20140521", "161222400.000000"],
            ["CS012513000197", "20190927", "20140915", "158803200.000000"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> receipt_distinct </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT distinct</span></span>\n<span class="line"><span style="color:#E6E6E6">        customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">        sales_ymd</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    c.customer_id,</span></span>\n<span class="line"><span style="color:#E6E6E6">    r.sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    c.application_date,</span></span>\n<span class="line"><span style="color:#E6E6E6">    EXTRACT(EPOCH </span><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> </span></span>\n<span class="line"><span style="color:#E6E6E6">            TO_TIMESTAMP(</span><span style="color:#DCDCAA">CAST</span><span style="color:#E6E6E6">(r.sales_ymd </span><span style="color:#569CD6">AS</span><span style="color:#569CD6"> VARCHAR</span><span style="color:#E6E6E6">), </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">) </span><span style="color:#D4D4D4">-</span><span style="color:#E6E6E6"> </span></span>\n<span class="line"><span style="color:#E6E6E6">            TO_TIMESTAMP(c.application_date, </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#E6E6E6">    ) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> elapsed_epoch</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">    receipt_distinct r</span></span>\n<span class="line"><span style="color:#569CD6">JOIN</span></span>\n<span class="line"><span style="color:#E6E6E6">    customer c</span></span>\n<span class="line"><span style="color:#569CD6">ON</span></span>\n<span class="line"><span style="color:#E6E6E6">    r.customer_id </span><span style="color:#D4D4D4">=</span><span style="color:#E6E6E6"> c.customer_id</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
  {
    id: "74",
    title: "[四則演算] 月曜からの経過日数",
    description:
      "レシート明細データ（receipt）の売上日（sales_ymd）に対し、当該週の月曜日からの経過日数を計算し、売上日、直前の月曜日付とともに10件表示せよ（sales_ymdは数値でデータを保持している点に注意）。",
    solutions: [
      {
        sql: "WITH elapsed_days_tbl AS (\n    SELECT\n        TO_DATE(CAST(sales_ymd AS VARCHAR), 'YYYYMMDD') AS sales_ymd,\n        EXTRACT(DOW FROM (\n            TO_DATE(CAST(sales_ymd AS VARCHAR), 'YYYYMMDD') - 1)) AS elapsed_days\n    FROM\n        receipt\n)\nSELECT\n    sales_ymd,\n    elapsed_days,\n    sales_ymd - CAST(elapsed_days AS INTEGER) AS monday\nFROM \n    elapsed_days_tbl\nLIMIT 10\n;",
        expectedResult: {
          fields: ["sales_ymd", "elapsed_days", "monday"],
          rows: [
            ["2018-11-03", "5", "2018-10-29"],
            ["2018-11-18", "6", "2018-11-12"],
            ["2017-07-12", "2", "2017-07-10"],
            ["2019-02-05", "1", "2019-02-04"],
            ["2018-08-21", "1", "2018-08-20"],
            ["2019-06-05", "2", "2019-06-03"],
            ["2018-12-05", "2", "2018-12-03"],
            ["2019-09-22", "6", "2019-09-16"],
            ["2017-05-04", "3", "2017-05-01"],
            ["2019-10-10", "3", "2019-10-07"],
          ],
        },
        sqlHtml:
          '<pre class="shiki slack-dark" style="background-color:#222222;color:#E6E6E6" tabindex="0"><code><span class="line"><span style="color:#569CD6">WITH</span><span style="color:#E6E6E6"> elapsed_days_tbl </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#569CD6">    SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">        TO_DATE(</span><span style="color:#DCDCAA">CAST</span><span style="color:#E6E6E6">(sales_ymd </span><span style="color:#569CD6">AS</span><span style="color:#569CD6"> VARCHAR</span><span style="color:#E6E6E6">), </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">        EXTRACT(DOW </span><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> (</span></span>\n<span class="line"><span style="color:#E6E6E6">            TO_DATE(</span><span style="color:#DCDCAA">CAST</span><span style="color:#E6E6E6">(sales_ymd </span><span style="color:#569CD6">AS</span><span style="color:#569CD6"> VARCHAR</span><span style="color:#E6E6E6">), </span><span style="color:#CE9178">\'YYYYMMDD\'</span><span style="color:#E6E6E6">) </span><span style="color:#D4D4D4">-</span><span style="color:#B5CEA8"> 1</span><span style="color:#E6E6E6">)) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> elapsed_days</span></span>\n<span class="line"><span style="color:#569CD6">    FROM</span></span>\n<span class="line"><span style="color:#E6E6E6">        receipt</span></span>\n<span class="line"><span style="color:#E6E6E6">)</span></span>\n<span class="line"><span style="color:#569CD6">SELECT</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd,</span></span>\n<span class="line"><span style="color:#E6E6E6">    elapsed_days,</span></span>\n<span class="line"><span style="color:#E6E6E6">    sales_ymd </span><span style="color:#D4D4D4">-</span><span style="color:#DCDCAA"> CAST</span><span style="color:#E6E6E6">(elapsed_days </span><span style="color:#569CD6">AS</span><span style="color:#569CD6"> INTEGER</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">AS</span><span style="color:#E6E6E6"> monday</span></span>\n<span class="line"><span style="color:#569CD6">FROM</span><span style="color:#E6E6E6"> </span></span>\n<span class="line"><span style="color:#E6E6E6">    elapsed_days_tbl</span></span>\n<span class="line"><span style="color:#569CD6">LIMIT</span><span style="color:#B5CEA8"> 10</span></span>\n<span class="line"><span style="color:#E6E6E6">;</span></span></code></pre>',
      },
    ],
  },
];

export const allProblemMap = new Map<string, Problem>(
  allProblems.map((problem) => [problem.id, problem]),
);
